/*
 * Academic License - for use in teaching, academic research, and meeting
 * course requirements at degree granting institutions only.  Not for
 * government, commercial, or other organizational use.
 *
 * MMregcore.c
 *
 * Code generation for function 'MMregcore'
 *
 */

/* Include files */
#include "MMregcore.h"
#include "HAwei.h"
#include "HYPwei.h"
#include "OPTwei.h"
#include "TBwei.h"
#include "bsxfun.h"
#include "chi2inv.h"
#include "find.h"
#include "fsdaC_data.h"
#include "fsdaC_emxutil.h"
#include "fsdaC_rtwutil.h"
#include "fsdaC_types.h"
#include "gammainc.h"
#include "minOrMax.h"
#include "mldivide.h"
#include "mtimes.h"
#include "rt_nonfinite.h"
#include "strcmp.h"
#include <math.h>
#include <string.h>

/* Function Definitions */
void MMregcore(const emxArray_real_T *y, const emxArray_real_T *X,
               const emxArray_real_T *b0, double auxscale, double varargin_2,
               const emxArray_char_T *varargin_6,
               const emxArray_real_T *varargin_8, double varargin_10,
               double varargin_12, double varargin_14, e_struct_T *out)
{
  static const double b_dv[900] = {0.5,
                                   0.51,
                                   0.52,
                                   0.53,
                                   0.54,
                                   0.55,
                                   0.56,
                                   0.57000000000000006,
                                   0.58,
                                   0.59,
                                   0.6,
                                   0.61,
                                   0.62,
                                   0.63,
                                   0.64,
                                   0.65,
                                   0.66,
                                   0.67,
                                   0.67999999999999994,
                                   0.69,
                                   0.7,
                                   0.71,
                                   0.72,
                                   0.73,
                                   0.74,
                                   0.75,
                                   0.76,
                                   0.77,
                                   0.78,
                                   0.79,
                                   0.8,
                                   0.81,
                                   0.82,
                                   0.83,
                                   0.84,
                                   0.85,
                                   0.86,
                                   0.87,
                                   0.88,
                                   0.89,
                                   0.9,
                                   0.91,
                                   0.91999999999999993,
                                   0.92999999999999994,
                                   0.94,
                                   0.95,
                                   0.96,
                                   0.97,
                                   0.98,
                                   0.99,
                                   2.3457952290773392,
                                   2.3592868475919762,
                                   2.3731582760810852,
                                   2.38741588624117,
                                   2.4020666070716281,
                                   2.4171197265386581,
                                   2.432585135102272,
                                   2.4484745664422238,
                                   2.464801549911499,
                                   2.4815803021192551,
                                   2.4988279938697815,
                                   2.5165632247391319,
                                   2.5348067097365856,
                                   2.5535814613103867,
                                   2.5729129910469055,
                                   2.5928292274475098,
                                   2.6133638173341751,
                                   2.6345496773719788,
                                   2.6564268507063389,
                                   2.6790386438369751,
                                   2.70243443311227,
                                   2.7266682684421539,
                                   2.7518022954463959,
                                   2.7779057323932648,
                                   2.8050575405359268,
                                   2.833347350358963,
                                   2.8628779053688049,
                                   2.8937674164772034,
                                   2.9261530078947544,
                                   2.9601941704750061,
                                   2.9960790574550629,
                                   3.0340303629636765,
                                   3.0743151903152466,
                                   3.1172576695680618,
                                   3.1632548570632935,
                                   3.2128027677536011,
                                   3.2665292620658875,
                                   3.3252482414245605,
                                   3.3900370299816132,
                                   3.4623700529336929,
                                   3.5443330407142639,
                                   3.6390225887298584,
                                   3.7513197660446167,
                                   3.8895976543426514,
                                   4.0701122283935547,
                                   4.331606388092041,
                                   4.8163948059082031,
                                   6.0,
                                   6.0,
                                   6.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   4.0,
                                   0.12121377625119291,
                                   0.13092706846910418,
                                   0.14086619137550521,
                                   0.15102225178972928,
                                   0.16138699021445574,
                                   0.17195351959405705,
                                   0.18271517659381775,
                                   0.19366601156227489,
                                   0.20480080639673687,
                                   0.21611492538552624,
                                   0.2276041477249,
                                   0.23926485533861058,
                                   0.25109404775282174,
                                   0.26308906778516972,
                                   0.2752477533328197,
                                   0.28756833749666383,
                                   0.30005004988126255,
                                   0.31269172551061458,
                                   0.32549326715462,
                                   0.33845486516897272,
                                   0.35157727995257793,
                                   0.36486163447813214,
                                   0.37830982155136295,
                                   0.39192417490733245,
                                   0.40570760380710347,
                                   0.4196637509347324,
                                   0.43379697788442995,
                                   0.44811242536855245,
                                   0.46261620612281212,
                                   0.4773153596251456,
                                   0.49221815374630895,
                                   0.507334187381999,
                                   0.52267459842796649,
                                   0.53825239765960853,
                                   0.5540827480809366,
                                   0.57018350836867215,
                                   0.58657581466694064,
                                   0.603284820854288,
                                   0.62034089717997731,
                                   0.63778110232012986,
                                   0.65565125237287813,
                                   0.67400955726210232,
                                   0.69293145337018314,
                                   0.7125182104387251,
                                   0.73291217658807661,
                                   0.7543276760491322,
                                   0.77712671163486791,
                                   0.79355184959720937,
                                   0.79355184959720937,
                                   0.79355184959720937,
                                   0.24618466376275877,
                                   0.25840433397619667,
                                   0.27064814936247217,
                                   0.28291662267056117,
                                   0.295210046445677,
                                   0.30752956811958165,
                                   0.3198757563013947,
                                   0.33224935178220216,
                                   0.34465122459901537,
                                   0.35708234950757867,
                                   0.36954362359157433,
                                   0.38203606888066322,
                                   0.39456090471167832,
                                   0.40711928412541887,
                                   0.41971247696096659,
                                   0.43234178625716674,
                                   0.44500902896570083,
                                   0.45771547509359378,
                                   0.47046298937023956,
                                   0.48325341056390736,
                                   0.49608880534268318,
                                   0.5089712786186773,
                                   0.52190331428725234,
                                   0.53488750968295851,
                                   0.547926662837146,
                                   0.56102389846545753,
                                   0.57418263982981943,
                                   0.58740664778782148,
                                   0.60070012792596816,
                                   0.61406769890339408,
                                   0.62751455966600045,
                                   0.64104655970013646,
                                   0.65467027794143307,
                                   0.668393215811228,
                                   0.68222394490199323,
                                   0.69617237869264437,
                                   0.71025009425250374,
                                   0.72447069554210852,
                                   0.73885044872663319,
                                   0.753409042400385,
                                   0.76817063835607047,
                                   0.78316581446651978,
                                   0.79843405031403358,
                                   0.81402821158971639,
                                   0.83002255510203993,
                                   0.84652896961049051,
                                   0.8637370242204,
                                   0.875861757268942,
                                   0.875861757268942,
                                   0.875861757268942,
                                   0.49034496545791728,
                                   0.51105729341507056,
                                   0.53161193132400619,
                                   0.55202207565307726,
                                   0.57230013608932628,
                                   0.59245947599411108,
                                   0.61251218318939316,
                                   0.63247022628784311,
                                   0.6523455619812023,
                                   0.67215006351471063,
                                   0.69189527034759624,
                                   0.71159279346466175,
                                   0.73125442266464313,
                                   0.75089179277420137,
                                   0.7705166697502146,
                                   0.7901409149169929,
                                   0.80977721214294573,
                                   0.8294375360012064,
                                   0.84913491606712455,
                                   0.86888254880905258,
                                   0.88869423866272068,
                                   0.90858420133590834,
                                   0.92856758832931618,
                                   0.94866023063659788,
                                   0.9688787937164316,
                                   0.98924111127853476,
                                   1.009766232967378,
                                   1.030474615097047,
                                   1.0513884305953987,
                                   1.072531706094743,
                                   1.0939307808876053,
                                   1.1156146526336688,
                                   1.137615400552751,
                                   1.1599688470363627,
                                   1.1827152311801921,
                                   1.2059001684188857,
                                   1.2295758485794082,
                                   1.253802502155305,
                                   1.2786505103111276,
                                   1.304203128814698,
                                   1.3305601477622997,
                                   1.3578437924385078,
                                   1.3862066745758064,
                                   1.4158448100090035,
                                   1.4470196366310126,
                                   1.4800994157791143,
                                   1.5156523227691663,
                                   1.5413827896118175,
                                   1.5413827896118175,
                                   1.5413827896118175,
                                   0.5,
                                   0.51,
                                   0.52,
                                   0.53,
                                   0.54,
                                   0.55,
                                   0.56,
                                   0.57000000000000006,
                                   0.58,
                                   0.59,
                                   0.6,
                                   0.61,
                                   0.62,
                                   0.63,
                                   0.64,
                                   0.65,
                                   0.66,
                                   0.67,
                                   0.67999999999999994,
                                   0.69,
                                   0.7,
                                   0.71,
                                   0.72,
                                   0.73,
                                   0.74,
                                   0.75,
                                   0.76,
                                   0.77,
                                   0.78,
                                   0.79,
                                   0.8,
                                   0.81,
                                   0.82,
                                   0.83,
                                   0.84,
                                   0.85,
                                   0.86,
                                   0.87,
                                   0.88,
                                   0.89,
                                   0.9,
                                   0.91,
                                   0.91999999999999993,
                                   0.92999999999999994,
                                   0.94,
                                   0.95,
                                   0.96,
                                   0.97,
                                   0.98,
                                   0.99,
                                   2.2140617519617081,
                                   2.2278026342391968,
                                   2.2418704368174076,
                                   2.2562711931318553,
                                   2.2710122466087341,
                                   2.286101222038269,
                                   2.3015473932027817,
                                   2.3173616466513964,
                                   2.3335554897785187,
                                   2.3501424193382263,
                                   2.3671368645629229,
                                   2.384555392689589,
                                   2.4024158120155334,
                                   2.4207384549081326,
                                   2.4395449757575989,
                                   2.4588600993156433,
                                   2.4787105023860931,
                                   2.499126136302948,
                                   2.5201400220394135,
                                   2.5417885547032908,
                                   2.564113050699234,
                                   2.5871584415435791,
                                   2.6109762340784073,
                                   2.635622501373291,
                                   2.6611630469560623,
                                   2.6876691877841949,
                                   2.7152240574359894,
                                   2.74392200845434,
                                   2.7738710045814514,
                                   2.8051967024803162,
                                   2.83804464712739,
                                   2.8725858056977076,
                                   2.909022242840801,
                                   2.9475959539413452,
                                   2.9885987639427185,
                                   3.0323883593082428,
                                   3.0794087052345276,
                                   3.1302205920219421,
                                   3.1855462193489075,
                                   3.2463383674621582,
                                   3.3138919472694397,
                                   3.3900238275527954,
                                   3.4774072766304016,
                                   3.5802048444747925,
                                   3.7054358720779419,
                                   3.8663873672485352,
                                   4.093386173248291,
                                   4.4867777824401855,
                                   6.0,
                                   6.0,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   4.5,
                                   0.16307596878080027,
                                   0.17356708776851226,
                                   0.18422965709981778,
                                   0.19505713841751282,
                                   0.20604396975517844,
                                   0.21718480553217462,
                                   0.22847508121093296,
                                   0.23991076582610493,
                                   0.25148804001253322,
                                   0.26320379932606297,
                                   0.27505527137497121,
                                   0.28704012682229962,
                                   0.29915629671199495,
                                   0.31140229813014825,
                                   0.32377682701630217,
                                   0.33627908438524312,
                                   0.34890862658425414,
                                   0.36166531522579615,
                                   0.37454948605169186,
                                   0.38756169128045537,
                                   0.40070317917037079,
                                   0.41397534651859458,
                                   0.4273801246203015,
                                   0.44091999692533118,
                                   0.45459785314478562,
                                   0.46841718822527428,
                                   0.482382134756954,
                                   0.49649747705064895,
                                   0.510768647110065,
                                   0.52520214812789634,
                                   0.53980542837120793,
                                   0.55458691895592993,
                                   0.569556432304618,
                                   0.5847254089401358,
                                   0.60010710571245784,
                                   0.6157170056348501,
                                   0.63157328917744748,
                                   0.64769750142860649,
                                   0.664115545751169,
                                   0.68085870108349245,
                                   0.6979655733955854,
                                   0.71548435689586853,
                                   0.73347692684635413,
                                   0.75202472338485471,
                                   0.77123938374104473,
                                   0.79128167594135956,
                                   0.81240214030308588,
                                   0.83504551769364677,
                                   0.85705752933023316,
                                   0.85705752933023316,
                                   0.28554857013504187,
                                   0.29752178840484322,
                                   0.30951481720224205,
                                   0.32152805487581554,
                                   0.33356220329444741,
                                   0.34561776785064235,
                                   0.35769546187164059,
                                   0.369796087562117,
                                   0.38192023396841646,
                                   0.3940688284825124,
                                   0.40624273309203923,
                                   0.41844291520274451,
                                   0.43067029802494616,
                                   0.44292600665866194,
                                   0.4552111279932245,
                                   0.46752690099323069,
                                   0.47987466399149936,
                                   0.49225578709581863,
                                   0.50467182441187952,
                                   0.51712433971415228,
                                   0.529615169430085,
                                   0.54214619742641179,
                                   0.55471947292214607,
                                   0.56733729087878582,
                                   0.58000208165307,
                                   0.59271653659000911,
                                   0.60548362931221378,
                                   0.61830661350256533,
                                   0.63118899430215047,
                                   0.6441348413056891,
                                   0.65714864868643375,
                                   0.67023532440703715,
                                   0.68340051322215944,
                                   0.69665062037657555,
                                   0.70999293351512949,
                                   0.72343586983344965,
                                   0.73698916674733472,
                                   0.75066425479007093,
                                   0.76447477754068038,
                                   0.77843705299962829,
                                   0.792571144662011,
                                   0.80690195527052255,
                                   0.82146136516789825,
                                   0.83629120959892222,
                                   0.85144877992056633,
                                   0.86701649026069849,
                                   0.88312290047524389,
                                   0.89999675066026452,
                                   0.91591122757804477,
                                   0.91591122757804477,
                                   0.59642152190208508,
                                   0.61707015037536761,
                                   0.63757696747779946,
                                   0.65795497894287225,
                                   0.67821733951568719,
                                   0.6983764886856092,
                                   0.71844491362571816,
                                   0.73843497633934085,
                                   0.758358472585679,
                                   0.77822756767273049,
                                   0.79805420637130831,
                                   0.817850410938264,
                                   0.83762807846069431,
                                   0.85739945769310111,
                                   0.877176767587663,
                                   0.89697258472442742,
                                   0.91679978370666615,
                                   0.93667148947715861,
                                   0.95660138130188077,
                                   0.97660350799560647,
                                   0.9966926634311688,
                                   1.0168842732906358,
                                   1.0371945261955273,
                                   1.0576406598091139,
                                   1.0782408773899086,
                                   1.0990146696567547,
                                   1.1199829995632189,
                                   1.1411684513092055,
                                   1.162595379352571,
                                   1.1842906475067148,
                                   1.2062836408615127,
                                   1.2286066055297866,
                                   1.2512955665588394,
                                   1.2743907809257522,
                                   1.297937572002412,
                                   1.3219874441623698,
                                   1.3465993165969863,
                                   1.371841287612916,
                                   1.3977930545806894,
                                   1.424548625946046,
                                   1.4522208333015454,
                                   1.48094683289528,
                                   1.5108969748020187,
                                   1.5422873497009288,
                                   1.5754008054733286,
                                   1.6106218695640584,
                                   1.648504835367204,
                                   1.689929294586183,
                                   1.7306834936141975,
                                   1.7306834936141975,
                                   0.5,
                                   0.51,
                                   0.52,
                                   0.53,
                                   0.54,
                                   0.55,
                                   0.56,
                                   0.57000000000000006,
                                   0.58,
                                   0.59,
                                   0.6,
                                   0.61,
                                   0.62,
                                   0.63,
                                   0.64,
                                   0.65,
                                   0.66,
                                   0.67,
                                   0.67999999999999994,
                                   0.69,
                                   0.7,
                                   0.71,
                                   0.72,
                                   0.73,
                                   0.74,
                                   0.75,
                                   0.76,
                                   0.77,
                                   0.78,
                                   0.79,
                                   0.8,
                                   0.81,
                                   0.82,
                                   0.83,
                                   0.84,
                                   0.85,
                                   0.86,
                                   0.87,
                                   0.88,
                                   0.89,
                                   0.9,
                                   0.91,
                                   0.91999999999999993,
                                   0.92999999999999994,
                                   0.94,
                                   0.95,
                                   0.96,
                                   0.97,
                                   0.98,
                                   0.99,
                                   2.1192206367850304,
                                   2.1332226395606995,
                                   2.1475160121917725,
                                   2.162105917930603,
                                   2.1769996573345471,
                                   2.19220532476902,
                                   2.2077316883951426,
                                   2.2235887201406834,
                                   2.2397876381874084,
                                   2.2563408799469471,
                                   2.2732621792425842,
                                   2.2905663251876831,
                                   2.308270186521348,
                                   2.3263921274724328,
                                   2.3449522629380226,
                                   2.3639728426933289,
                                   2.3834781348705292,
                                   2.4034952206662696,
                                   2.424053430557251,
                                   2.4451864212751389,
                                   2.466929908820946,
                                   2.4893247038125992,
                                   2.5124157071113586,
                                   2.5362534672021866,
                                   2.5608944594860077,
                                   2.5864022374153137,
                                   2.6128487586975098,
                                   2.6403167247772217,
                                   2.66889843424142,
                                   2.6987014412879944,
                                   2.7298508584499359,
                                   2.7624910771846771,
                                   2.7967924177646637,
                                   2.8329567313194275,
                                   2.8712254166603088,
                                   2.91189181804657,
                                   2.9553149044513702,
                                   3.0019434690475464,
                                   3.05234557390213,
                                   3.107258677482605,
                                   3.1676606157561764,
                                   3.2348912954330444,
                                   3.3108530044555664,
                                   3.3983867168426514,
                                   3.50199556350708,
                                   3.6294994354248047,
                                   3.7963486073106711,
                                   4.0407001972198486,
                                   4.5170249938964844,
                                   6.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   5.0,
                                   0.19846960223780408,
                                   0.20939567022790329,
                                   0.22045639952569929,
                                   0.23164710912035069,
                                   0.24296352134970406,
                                   0.254401859685533,
                                   0.26595875873506136,
                                   0.27763130012123483,
                                   0.28941683982806954,
                                   0.30131315516588253,
                                   0.31331846786840517,
                                   0.32543089309865064,
                                   0.33764954730821228,
                                   0.34997333632394312,
                                   0.36240161845866747,
                                   0.37493412226234557,
                                   0.38757079619745438,
                                   0.40031199010217455,
                                   0.41315822437018473,
                                   0.42611044244907859,
                                   0.43916996753834259,
                                   0.45233845065340028,
                                   0.46561783835325365,
                                   0.47901056418612842,
                                   0.49251949828303537,
                                   0.50614799332888261,
                                   0.519900003947177,
                                   0.53377970571031841,
                                   0.54779262578529131,
                                   0.56194421314056919,
                                   0.57624150998240609,
                                   0.590692158247323,
                                   0.60530507181490467,
                                   0.6200904262421626,
                                   0.63506011872195489,
                                   0.6502279632461242,
                                   0.66561016598834533,
                                   0.68122587758466335,
                                   0.6970979530664696,
                                   0.71325401335679228,
                                   0.72972789478961686,
                                   0.746561776392587,
                                   0.76380940198569347,
                                   0.78154102550699123,
                                   0.79985178897196785,
                                   0.81887645206688053,
                                   0.83881929396616772,
                                   0.86002078952410121,
                                   0.883169838364464,
                                   0.899024388098336,
                                   0.3150155553288837,
                                   0.32679013634090781,
                                   0.33858134381433685,
                                   0.35038973395614037,
                                   0.36221583891954212,
                                   0.37406018659136075,
                                   0.385923444582161,
                                   0.39780629374065568,
                                   0.40970937122332723,
                                   0.42163344501602629,
                                   0.43357941605199324,
                                   0.4455478015406511,
                                   0.45753985034180844,
                                   0.46955639299366947,
                                   0.48159841942571591,
                                   0.493667071793363,
                                   0.50576350725465047,
                                   0.517889036533843,
                                   0.53004489847411485,
                                   0.54223261089907471,
                                   0.55445376956263925,
                                   0.56671007040951538,
                                   0.57900332012064393,
                                   0.59133553516406812,
                                   0.60370889103222913,
                                   0.616125795065378,
                                   0.62858889922367134,
                                   0.64110090372537609,
                                   0.65366522726721143,
                                   0.66628517138822252,
                                   0.67896480292124017,
                                   0.69170849722806882,
                                   0.70452122756847468,
                                   0.71740856819077869,
                                   0.73037695769896238,
                                   0.74343376705525921,
                                   0.75658756622930878,
                                   0.76984836758202646,
                                   0.78322806362010455,
                                   0.79674090453936164,
                                   0.81040428465610381,
                                   0.82423977972513185,
                                   0.838274805825644,
                                   0.8525451015530795,
                                   0.86709900666087325,
                                   0.88200488811132671,
                                   0.89736649086933828,
                                   0.91335654036141911,
                                   0.93032598450498749,
                                   0.94155553895923316,
                                   0.68405969142913947,
                                   0.70465374588966478,
                                   0.72511978745460592,
                                   0.745471233129502,
                                   0.76572103500366306,
                                   0.78588187694549694,
                                   0.80596638321876612,
                                   0.82598702907562349,
                                   0.84595598578453168,
                                   0.86588558554649453,
                                   0.88578827381134162,
                                   0.90567586421966662,
                                   0.92556138038635338,
                                   0.94545724391937347,
                                   0.965376240015031,
                                   0.98533162474632352,
                                   1.0053368687629709,
                                   1.0254060268402112,
                                   1.0455534100532542,
                                   1.0657941699028022,
                                   1.0861441612243661,
                                   1.1066199839115158,
                                   1.1272391557693497,
                                   1.148020350933076,
                                   1.1689834654331219,
                                   1.1901498854160317,
                                   1.2115427017211922,
                                   1.2331865668296829,
                                   1.2551090240478526,
                                   1.277339529991151,
                                   1.2999110460281385,
                                   1.3228599071502698,
                                   1.346226686239244,
                                   1.3700568437576308,
                                   1.3944019377231609,
                                   1.4193206846714037,
                                   1.4448806285858167,
                                   1.471160119771959,
                                   1.4982511043548592,
                                   1.5262626111507436,
                                   1.5553258180618297,
                                   1.5856008648872393,
                                   1.6172869563102734,
                                   1.6506372392177593,
                                   1.6859823286533364,
                                   1.7237689495086683,
                                   1.7646308779716506,
                                   1.8095285058021551,
                                   1.8601212739944464,
                                   1.8952456235885629};
  static const double EFF[50] = {0.5,
                                 0.51,
                                 0.52,
                                 0.53,
                                 0.54,
                                 0.55,
                                 0.56,
                                 0.57000000000000006,
                                 0.58,
                                 0.59,
                                 0.6,
                                 0.61,
                                 0.62,
                                 0.63,
                                 0.64,
                                 0.65,
                                 0.66,
                                 0.67,
                                 0.67999999999999994,
                                 0.69,
                                 0.7,
                                 0.71,
                                 0.72,
                                 0.73,
                                 0.74,
                                 0.75,
                                 0.76,
                                 0.77,
                                 0.78,
                                 0.79,
                                 0.8,
                                 0.81,
                                 0.82,
                                 0.83,
                                 0.84,
                                 0.85,
                                 0.86,
                                 0.87,
                                 0.88,
                                 0.89,
                                 0.9,
                                 0.91,
                                 0.91999999999999993,
                                 0.92999999999999994,
                                 0.94,
                                 0.95,
                                 0.96,
                                 0.97,
                                 0.98,
                                 0.99};
  static const char b_cv[5] = {'M', 'M', 'r', 'e', 'g'};
  static const char cv2[3] = {'O', 'P', 'T'};
  static const char cv1[2] = {'T', 'B'};
  static const char cv3[2] = {'H', 'A'};
  emxArray_boolean_T *c_y;
  emxArray_int32_T *r;
  emxArray_int32_T *r2;
  emxArray_real_T *b1;
  emxArray_real_T *b_y;
  emxArray_real_T *c;
  emxArray_real_T *r1;
  emxArray_real_T *x;
  creal_T a_tmp_tmp;
  creal_T b_a_tmp;
  creal_T bet_tmp;
  creal_T c_a_tmp;
  double varargin_1[50];
  double row[5];
  double b_varargin_1[3];
  double B2=0;
  double F;
  double a;
  double a2=0;
  double a_tmp;
  double b;
  double b2=0;
  double b_a;
  double b_c;
  double b_step;
  double c2=0;
  double ctun=0;
  double iter;
  int psifunc_class_size[2];
  int exitg1;
  int i;
  int k;
  int nx;
  char psifunc_class_data[3];
  bool b_bool;
  /* MMregcore computes MM regression estimators for a selected fixed scale. */
  /*  */
  /* <a href="matlab: docsearchFS('MMregcore')">Link to the help function</a> */
  /*  */
  /*   Required input arguments: */
  /*  */
  /*     y: Response variable. Vector. A vector with n elements that contains */
  /*        the response variable. y can be either a row or a column vector. */
  /*     X: Data matrix of explanatory variables (also called 'regressors') of
   */
  /*        dimension (n x p-1). Rows of X represent observations, and columns
   */
  /*        represent variables. */
  /*        Missing values (NaN's) and infinite values (Inf's) are allowed, */
  /*        since observations (rows) with missing or infinite values will */
  /*        automatically be excluded from the computations. */
  /*     b0:        Initial estimate of beta. Vector. Vector containing initial
   */
  /*                estimate of beta (generally an S estimate with high */
  /*                breakdown point (e.g. 0.5) */
  /*  auxscale:     scale estimate. Scalar. */
  /*                Scalar containing estimate of the scale (generally an S */
  /*                estimate with high breakdown point (e.g. .5) */
  /*  */
  /*   Optional input arguments: */
  /*  */
  /*     intercept :  Indicator for constant term. true (default) | false. */
  /*                  Indicator for the constant term (intercept) in the fit, */
  /*                  specified as the comma-separated pair consisting of */
  /*                  'Intercept' and either true to include or false to remove
   */
  /*                  the constant term from the model. */
  /*                  Example - 'intercept',false */
  /*                  Data Types - boolean */
  /*  */
  /*       eff     : nominal efficiency. Scalar. */
  /*                 Scalar defining nominal efficiency (i.e. a number between
   */
  /*                  0.5 and 0.99). The default value is 0.95 */
  /*                  Asymptotic nominal efficiency is: */
  /*                  $(\int \psi' d\Phi)^2 / (\psi^2 d\Phi)$ */
  /*                  Example - 'eff',0.99 */
  /*                  Data Types - double */
  /*  */
  /*      effshape : locacation or scale effiicency. dummy scalar. */
  /*                 If effshape=1 efficiency refers to shape */
  /*                 efficiency else (default) efficiency refers to location */
  /*                  Example - 'effshape',1 */
  /*                  Data Types - double */
  /*  */
  /*      refsteps  : Maximum iterations. Scalar. */
  /*                  Scalar defining maximum number of iterations in the MM */
  /*                  loop. Default value is 100. */
  /*                  Example - 'refsteps',10 */
  /*                  Data Types - double */
  /*  */
  /*       reftol: Tolerance. Scalar. */
  /*                  Scalar controlling tolerance in the MM loop. */
  /*                  Default value is 1e-7 */
  /*                  Example - 'tol',1e-10 */
  /*                  Data Types - double */
  /*  */
  /*      conflev :  Confidence level which is */
  /*                used to declare units as outliers. Scalar. */
  /*                Usually conflev=0.95, 0.975 0.99 (individual alpha) */
  /*                or 1-0.05/n, 1-0.025/n, 1-0.01/n (simultaneous alpha). */
  /*                Default value is 0.975 */
  /*                  Example - 'conflev',0.99 */
  /*                  Data Types - double */
  /*  */
  /*      rhofunc : rho function. String. String which specifies the rho */
  /*                function which must be used to weight the residuals. */
  /*                Possible values are */
  /*                'bisquare'; */
  /*                'optimal'; */
  /*                'hyperbolic'; */
  /*                'hampel'; */
  /*                'mdpd'. */
  /*                'bisquare' uses Tukey's $\rho$ and $\psi$ functions. */
  /*                See TBrho and TBpsi. */
  /*                'optimal' uses optimal $\rho$ and $\psi$ functions. */
  /*                See OPTrho and OPTpsi. */
  /*                'hyperbolic' uses hyperbolic $\rho$ and $\psi$ functions. */
  /*                See HYPrho and HYPpsi. */
  /*                'hampel' uses Hampel $\rho$ and $\psi$ functions. */
  /*                See HArho and HApsi. */
  /*                'mdpd' uses Minimum Density Power Divergence $\rho$ and
   * $\psi$ functions. */
  /*                See PDrho.m and PDpsi.m. */
  /*                The default is bisquare */
  /*                  Example - 'rhofunc','optimal' */
  /*                  Data Types - char */
  /*  */
  /*  rhofuncparam: Additional parameters for the specified rho function. */
  /*                Scalar or vector or empty  value. */
  /*                For hyperbolic rho function it is possible to set up the */
  /*                value of k = sup CVC (the default value of k is 4.5). */
  /*                For Hampel rho function it is possible to define parameters
   */
  /*                a, b and c (the default values are a=2, b=4, c=8). For the
   */
  /*                other rho functions (Tuhey, PD and optimal) it is an empty
   */
  /*                value. */
  /*                  Example - 'rhofuncparam',5 */
  /*                  Data Types - single | double */
  /*  */
  /*        nocheck : Check input arguments. Boolean. If nocheck is equal to */
  /*                true no check is performed on matrix y and matrix X. Notice
   */
  /*                that y and X are left unchanged. In other words the */
  /*                additional column of ones for the intercept is not added. */
  /*                As default nocheck=false. */
  /*                Example - 'nocheck',true */
  /*                Data Types - boolean */
  /*  */
  /*        plots : Plot on the screen. Scalar or structure. */
  /*                If plots = 1, generates a plot with the robust residuals */
  /*                against index number. The confidence level used to draw the
   */
  /*                confidence bands for the residuals is given by the input */
  /*                option conflev. If conflev is not specified a nominal 0.975
   */
  /*                confidence interval will be used. */
  /*                  Example - 'plots',0 */
  /*                  Data Types - single | double */
  /*  */
  /*        yxsave : the response vector y and data matrix X are saved into the
   * output */
  /*                 structure out. Scalar. */
  /*                Default is 0, i.e. no saving is done. */
  /*                Example - 'yxsave',1 */
  /*                Data Types - double */
  /*  */
  /*   Output: */
  /*  */
  /*       out :     A structure containing the following fields */
  /*  */
  /*        out.beta  = p x 1 vector. Estimate of beta coefficients after */
  /*                    refsteps refining steps */
  /*    out.residuals = n x 1 vector containing the estimates of the robust */
  /*                    scaled residuals */
  /*    out.outliers  = A vector containing the list of the units declared as */
  /*                    outliers using confidence level specified in input */
  /*                    scalar conflev */
  /*    out.conflev   = Confidence level that was used to declare outliers */
  /*    out.weights   = n x 1 vector. Weights assigned to each observation */
  /*      out.rhofunc = string identifying the rho function which has been */
  /*                    used. */
  /*  out.rhofuncparam= vector which contains the additional parameters */
  /*                    for the specified rho function which have been */
  /*                    used. For hyperbolic rho function the value of */
  /*                    k =sup CVC. For Hampel rho function the parameters */
  /*                    a, b and c. This field is empty if rhofunc is not */
  /*                    'hampel' or 'hyperbolic'. */
  /*      out.y       = response vector y. The field is present only if option
   */
  /*                    yxsave is set to 1. */
  /*      out.X       = data matrix X. The field is present only if option */
  /*                    yxsave is set to 1. */
  /*      out.class   = 'MMreg' */
  /*  */
  /*  */
  /*  More About: */
  /*  */
  /*  It does iterative reweighted least squares (IRWLS) steps from "initial */
  /*  beta" (b0) keeping the estimate of the scale (auxscale) fixed. */
  /*  */
  /*  See also: Sreg */
  /*  */
  /*  References: */
  /*  */
  /*  Maronna, R.A., Martin D. and Yohai V.J. (2006), "Robust Statistics, Theory
   */
  /*  and Methods", Wiley, New York. */
  /*  */
  /*  Acknowledgements: */
  /*  */
  /*  This function follows the lines of MATLAB/R code developed during the */
  /*  years by many authors. */
  /*  For more details see http://www.econ.kuleuven.be/public/NDBAE06/programs/
   */
  /*  and the R library robustbase http://robustbase.r-forge.r-project.org/. */
  /*  The core of these routines, e.g. the resampling approach, however, has */
  /*  been completely redesigned, with considerable increase of the */
  /*  computational performance. */
  /*  */
  /*  Copyright 2008-2021. */
  /*  Written by FSDA team */
  /*  */
  /*  */
  /* <a href="matlab: docsearchFS('MMregcore')">Link to the help page for this
   * function</a> */
  /*  */
  /* $LastChangedDate::                      $: Date of the last commit */
  /*  Examples: */
  /*  */
  /* { */
  /*     % MMregcore with all default options. */
  /*     n=200; */
  /*     p=3; */
  /*     state1=123456; */
  /*     randn('state', state1); */
  /*     X=randn(n,p); */
  /*     y=randn(n,1); */
  /*     kk=10; */
  /*     ycont = y; */
  /*     ycont(1:kk)=ycont(1:kk)+7; */
  /*     [outS]=Sreg(ycont,X); */
  /*     outMM=MMregcore(ycont,X,outS.beta,outS.scale) */
  /* } */
  /* { */
  /*     %% MMregcore with optional input arguments. */
  /*     % Determine, e.g., an S estimate and extract the required arguments for
   * the MM estimate. */
  /*     n=200; */
  /*     p=3; */
  /*     state1=123456; */
  /*     randn('state', state1); */
  /*     X=randn(n,p); */
  /*     y=randn(n,1); */
  /*     kk=10; */
  /*     ycont = y; */
  /*     ycont(1:kk)=ycont(1:kk)+7; */
  /*     [outS]=Sreg(ycont,X); */
  /*     out=MMregcore(ycont,X,outS.beta,outS.scale,'plots',1) */
  /* } */
  /* { */
  /*     % Weighting the residuals with a rho function. */
  /*     % Determine, e.g., an S estimate and extract the required arguments for
   * the MM estimate. */
  /*     % This time use a Tukey biweight for S estimation and HA rho function
   */
  /*     % for MM loop */
  /*     n=200; */
  /*     p=3; */
  /*     state1=123456; */
  /*     randn('state', state1); */
  /*     X=randn(n,p); */
  /*     y=randn(n,1); */
  /*     kk=10; */
  /*     ycont = y; */
  /*     ycont(1:kk)=ycont(1:kk)+7; */
  /*     [outS]=Sreg(ycont,X); */
  /*     rhofunc='hampel'; */
  /*     outMM1=MMregcore(ycont,X,outS.beta,outS.scale,'rhofunc',rhofunc,'plots',1)
   */
  /* } */
  /* { */
  /*     % Comparison between direct call to MMreg and call to Sreg and
   * MMregcore. */
  /*     % In this example two different rho functions are used for S and MM */
  /*     n=30; */
  /*     p=3; */
  /*     randn('state', 16); */
  /*     X=randn(n,p); */
  /*     % Uncontaminated data */
  /*     y=randn(n,1); */
  /*     % Contaminated data */
  /*     ycont=y; */
  /*     ycont(1:5)=ycont(1:5)+6; */
  /*     % Two different rho functions are used for S and MM */
  /*     rhofuncS='hyperbolic'; */
  /*     rhofuncMM='hampel'; */
  /*     % Direct call to MMreg */
  /*     [out]=MMreg(ycont,X,'Srhofunc',rhofuncS,'rhofunc',rhofuncMM,'Snsamp',0);
   */
  /*  */
  /*     % Call to Sreg and then to MMregcore */
  /*     [outS]=Sreg(ycont,X,'rhofunc',rhofuncS,'nsamp',0); */
  /*     outMM=MMregcore(ycont,X,outS.beta,outS.scale,'rhofunc',rhofuncMM); */
  /*     disp('Difference between direct call to S and the calls to Sreg and
   * MMregcore') */
  /*     max(abs([out.beta-outMM.beta])) */
  /* } */
  /*  Beginning of code */
  /* chkinputR makes some input parameters and user options checking in
   * regression */
  /*  */
  /*  Required input arguments: */
  /*  */
  /*  y:            Response variable. Vector. */
  /*                A vector with n elements that contains the response */
  /*                variables, possibly with missing values (NaN's) and */
  /*                infinite values (Inf's). */
  /*  X :           Predictor variables. Matrix. */
  /*                Data matrix of explanatory variables (also called */
  /*                'regressors') of dimension (n x p-1), possibly with missing
   */
  /*                values (NaN's) and infinite values (Inf's). Rows of X */
  /*                represent observations, and columns represent variables. */
  /*  nnargin:      nargin. Scalar. The number of input arguments specified for
   * the caller */
  /*                function. */
  /*  vvarargin:    nvarargin. Scalar. The variable length input argument list
   */
  /*                specified for the */
  /*                caller function. */
  /*  */
  /*  */
  /*   Optional input arguments: */
  /*  */
  /*  Output: */
  /*  */
  /*  y:            response without missing and infs. Vector. The new response
   * variable, with observations (rows) with */
  /*                missing or infinite values excluded. */
  /*  X:            Predictor variables without infs and missings. Matrix. */
  /*                The new matrix of explanatory variables, with missing or */
  /*                infinite values excluded. */
  /*  n:            Number of rows of X (observations). Scalar.  Number of */
  /*                rows after listwise exclusion. */
  /*  p:            Number of columns of X (variables). Scalar. */
  /*                Number of parameters to be estimated. */
  /*  */
  /*  */
  /*  More About: */
  /*  */
  /*  This routines preforms the following operations: */
  /*  1) If y is a row vector it is transformed in a column vector; */
  /*  2) Checks that X is a matrix that has not more than two dimensions; */
  /*  3) Checks dimension consistency of X and y; */
  /*  4) Removes observations with missing or infinite values from X or y */
  /*  (listwise exclusion); */
  /*  5) Adds to matrix X a column of ones if option intercept is 1; */
  /*  6) Checks if there are constant columns in matrix X. In other words, if */
  /*  Xj is a generic column of X (excluding the column which contains the */
  /*  intercept) it removes it if max(Xj)=min(Xj) and produces a warning. */
  /*  7) Computes final values of n and p after previous operations; */
  /*  8) Makes sure than n>=p; */
  /*  9) Makes sure that new X is full rank */
  /*  */
  /*  See also chkinputRB */
  /*  */
  /*  Copyright 2008-2021. */
  /*  Written by FSDA team */
  /*  */
  /*  */
  /*  */
  /* $LastChangedDate::                      $: Date of the last commit */
  /*  */
  /*  Example: */
  /* { */
  /*  example_producing_error */
  /*     %To examplify the behaviour of chkinputR, we call function FSR without
   * a */
  /*     %compulsory parameter ('y'). */
  /*     n=200; */
  /*     p=3; */
  /*     state1=123498; */
  /*     randn('state', state1); */
  /*     X=randn(n,p); */
  /*     [out]=FSR(X); */
  /* } */
  /*  Beginning of code */
  /*  chklist is the vector containing the names of optional arguments */
  /*  chkchk is the position of the option nocheck in vector chklist */
  /*  chkchk = strmatch('nocheck',chklist,'exact'); */
  /*  chkint is the position of the option intercept in vector chklist */
  /*  chkint = strmatch('intercept',chklist,'exact'); */
  /*  If nocheck=true, then skip checks on y and X */
  /*  default nominal efficiency */
  /*  by default the nominal efficiency refers to location efficiency */
  /*  default value of number of maximum refining iterations */
  /*  default value of tolerance for the refining steps convergence */
  /*  rho (psi) function which has to be used to weight the residuals */
  /*  MATLAB c coder initialization */
  /*  Write in structure 'options' the options chosen by the user */
  /*  nominal efficiency */
  /*  nominal efficiency refers to shape or location */
  /*  maximum refining iterations */
  /*  tolerance for refining iterations covergence */
  /*  String which specifies the function to use to weight the residuals */
  emxInit_real_T(&c, 2);
  if (l_strcmp(varargin_6)) {
    /*  Compute tuning constant associated to the requested nominal efficiency
     */
    /*  c = consistency factor for a given value of efficiency */
    /* Tbeff finds the constant c which is associated to the requested
     * efficiency for Tukey's biweight */
    /*  */
    /*  */
    /*  */
    /* <a href="matlab: docsearchFS('TBeff')">Link to the help function</a> */
    /*  */
    /*  */
    /*   Required input arguments: */
    /*  */
    /*     eff:       required efficienty. Scalar. */
    /*                Scalar which contains the required efficiency (of location
     */
    /*                or scale estimator). */
    /*                Data Types - single|double */
    /*                Generally eff=0.85, 0.9 or 0.95 */
    /*     v :        Number of response variables. Scalar. e.g. in regression
     * p=1 */
    /*                Data Types - single|double|int32|int64 */
    /*  */
    /*   Optional input arguments: */
    /*  */
    /*    shapeeff : Location or shape efficiency. Scalar. */
    /*               If 1, the efficiency is referred to shape else (default) */
    /*               is referred to location */
    /*                Example - 'shapeeff',1 */
    /*                Data Types - double */
    /*  */
    /*  approxsheff: approximate or exact calculations. Dummy scalar. */
    /*               If 1, when p > 1 the approximate formula for scale */
    /*               efficiency is used else (default) the exact formula of the
     */
    /*               variance of the robust estimator of the scale is used */
    /*                Example - 'approxsheff',1 */
    /*                Data Types - double */
    /*  */
    /*  */
    /*  Output: */
    /*  */
    /*   ceff : Requested tuning constant. Scalar. Tuning constatnt of Tukey
     * Biweigh rho */
    /*          function associated to requested value of efficiency */
    /*  */
    /*  See also: OPTeff, HYPeff, HAeff */
    /*  */
    /*  References: */
    /*   */
    /*  Maronna, R.A., Martin D. and Yohai V.J. (2006), "Robust Statistics,
     * Theory */
    /*  and Methods", Wiley, New York. */
    /*  */
    /*  Copyright 2008-2021. */
    /*  Written by FSDA team */
    /*  */
    /*  */
    /* <a href="matlab: docsearchFS('TBeff')">Link to the help page for this
     * function</a> */
    /*  */
    /* $LastChangedDate::                      $: Date of the last commit */
    /*  */
    /*  */
    /*  Examples: */
    /*  */
    /* { */
    /*     % Find c for a given efficiency. */
    /*     % The constant c associated to a nominal location efficiency of 95%
     * in regression is */
    /*     % c = 4.685064948559557 */
    /*     c=TBeff(0.95,1) */
    /* } */
    /* { */
    /*     % Find c associated to a fixed shape efficiency  */
    /*     % c= 5.490249208447494 */
    /*     c=TBeff(0.95,1,1) */
    /* } */
    /*  */
    /*  */
    /*  */
    /* { */
    /*     % Find shape efficiency. */
    /*     % Compare constant c for the range of values of p from 1 to 200 using
     */
    /*     % approximate and exact formula for fixed shape efficiency */
    /*     % Number of variables */
    /*     p=200; */
    /*     pp=1:1:p; */
    /*     % Initialize the matrix which stores the values of c for the two */
    /*     % methods */
    /*     cc=[pp' zeros(p,2)]; */
    /*  */
    /*     eff=0.75; */
    /*     % eff=0.99; */
    /*     for i=pp */
    /*         % Use exact formula for finding the value of c associated to a
     * fixed */
    /*         % level of shape efficiency */
    /*         cc(i,2)=TBeff(eff,i,1); */
    /*         % Use approximate formula for finding the value of c associated
     * to a fixed */
    /*         % level of shape efficiency */
    /*         cc(i,3)=TBeff(eff,i,1,1); */
    /*     end */
    /*     figure */
    /*     plot(cc(:,1),cc(:,2),'LineStyle','-','LineWidth',2) */
    /*     hold('on') */
    /*     plot(cc(:,1),cc(:,3),'LineStyle','-.','LineWidth',2) */
    /*     legend('True value of c', 'Approximate value of c','Location','best')
     */
    /*     xlabel('Number of variables') */
    /*     ylabel('Value of c') */
    /* } */
    /*  */
    /*  Beginning of code */
    /*  LOCATION EFFICIENCY */
    b_c = 2.0;
    /*  c = starting point of the iteration */
    /*  Remark: the more refined approximation for the starting value of */
    /*  sqrt(chi2inv(eff,p))+2; does not seem to be necessary in the case of */
    /*  location efficiency */
    /*  step = width of the dichotomic search (it decreases by half at each */
    /*  iteration). */
    b_step = 30.0;
    /*  Convergence condition is  */
    /*   ....... */
    /*  bet  = \int_{-c}^c  \psi'(x) d \Phi(x) */
    /*  alph = \int_{-c}^c  \psi^2(x) d \Phi(x) */
    /*  empeff = bet^2/alph = 1 / [var (robust estimator of location)] */
    F = 10.0;
    while (fabs(F - varargin_2) > 1.0E-12) {
      F = b_c * b_c;
      b2 = F / 2.0;
      b_a_tmp = gammainc(b2, 2.5);
      c_a_tmp = gammainc(b2, 1.5);
      b = 15.0 * b_a_tmp.re;
      iter = rt_powd_snf(b_c, 4.0);
      if (15.0 * b_a_tmp.im == 0.0) {
        B2 = b / iter;
      } else if (b == 0.0) {
        B2 = 0.0;
      } else {
        B2 = b / iter;
      }
      b = 6.0 * c_a_tmp.re;
      if (6.0 * c_a_tmp.im == 0.0) {
        a2 = b / F;
      } else if (b == 0.0) {
        a2 = 0.0;
      } else {
        a2 = b / F;
      }
      a = (B2 - a2) + (gammainc(b2, 0.5)).re;
      a_tmp_tmp = gammainc(b2, 5.5);
      b = 945.0 * a_tmp_tmp.re;
      F = rt_powd_snf(b_c, 8.0);
      if (945.0 * a_tmp_tmp.im == 0.0) {
        B2 = b / F;
      } else if (b == 0.0) {
        B2 = 0.0;
      } else {
        B2 = b / F;
      }
      a_tmp_tmp = gammainc(b2, 4.5);
      b = 420.0 * a_tmp_tmp.re;
      F = rt_powd_snf(b_c, 6.0);
      if (420.0 * a_tmp_tmp.im == 0.0) {
        a2 = b / F;
      } else if (b == 0.0) {
        a2 = 0.0;
      } else {
        a2 = b / F;
      }
      a_tmp_tmp = gammainc(b2, 3.5);
      b = 90.0 * a_tmp_tmp.re;
      if (90.0 * a_tmp_tmp.im == 0.0) {
        iter = b / iter;
      } else if (b == 0.0) {
        iter = 0.0;
      } else {
        iter = b / iter;
      }
      b = 6.0 * b_a_tmp.re;
      if (6.0 * b_a_tmp.im == 0.0) {
        F = b / b2;
      } else if (b == 0.0) {
        F = 0.0;
      } else {
        F = b / b2;
      }
      F = a * a / ((((B2 - a2) + iter) - F) + c_a_tmp.re);
      b_step /= 2.0;
      if (F < varargin_2) {
        b_c += b_step;
      } else if (F > varargin_2) {
        b_c = fmax(b_c - b_step, 0.1);
      }
    }
    /*  Remark: */
    /*  chi2cdf(x,v) = gamcdf(x,v/2,2) = gammainc(x ./ 2, v/2); */
    i = c->size[0] * c->size[1];
    c->size[0] = 1;
    c->size[1] = 1;
    emxEnsureCapacity_real_T(c, i);
    c->data[0] = b_c;
    /* TODO:MMregcore:shapeff */
    psifunc_class_size[0] = 1;
    psifunc_class_size[1] = 2;
    psifunc_class_data[0] = 'T';
    psifunc_class_data[1] = 'B';
    out->rhofuncparam->size[0] = 0;
    out->rhofuncparam->size[1] = 0;
  } else if (m_strcmp(varargin_6)) {
    /*  Compute tuning constant associated to the requested nominal efficiency
     */
    /*  c2 = consistency factor for a given value of efficiency */
    /*  Remark: given that in function OPTeff rho function is defined in the
     * interval 0---2c/3, 2c/3---3c/3, >3c/3 */
    /*  it is necessary to divide the output of OPTeff by 3 */
    /* OPTeff finds the constant c which is associated to the requested
     * efficiency */
    /*  */
    /* <a href="matlab: docsearchFS('OPTeff')">Link to the help function</a> */
    /*  */
    /*   Required input arguments: */
    /*  */
    /*     eff:       required efficienty. Scalar. */
    /*                Scalar which contains the required efficiency (of location
     */
    /*                or scale estimator). */
    /*                Generally eff=0.85, 0.9 or 0.95 */
    /*                Data Types - single|double */
    /*     v :        Number of response variables. Scalar. e.g. in regression
     * p=1 */
    /*                Data Types - single|double|int32|int64 */
    /*                 */
    /*  */
    /*   Optional input arguments: TODO_OPTeff_INPUT_OPTIONS */
    /*    */
    /*  */
    /*  */
    /*  Output: */
    /*  */
    /*   ceff : Requested tuning constant. Scalar. Tuning constatnt of optimal
     * rho */
    /*          function associated to requested value of efficiency */
    /*  */
    /*  More About: */
    /*  */
    /*  */
    /*     $\rho$ ($\psi$) function which is considered is standardized  */
    /*     using intervals 0---(2/3)c , (2/3)c---c, >c.    */
    /*     $\rho$ function is */
    /*  */
    /*  \[ */
    /*  TBrho(u)= \left\{ */
    /*     \begin{array}{lr} */
    /*      1.3846 \left(\frac{u}{c}\right)^2                      &
     * |\frac{u}{c}| \leq  \frac{2}{3} \\ */
    /*     0.5514-2.6917 \left(\frac{u}{c}\right)^2
     * +10.7668\left(\frac{u}{c}\right)^4-11.6640\left(\frac{u}{c}\right)^6+4.0375\left(\frac{u}{c}\right)^8
     * & \qquad \frac{2}{3} \leq  |\frac{u}{c}|\leq  1 \\ */
    /*     1                                                    &
     * |\frac{u}{c}|>1 \\ */
    /*  \end{array} */
    /*     \right. */
    /*   \] */
    /*                                                                       |t/c|>1
     */
    /*  */
    /*    Therefore, to obtain the value of c for the (rho) psi function defined
     * in the */
    /*    interval 0---2c, 2c---3c, >3c it is necessary to divide the output of
     */
    /*    function OPTeff by 3. */
    /*  */
    /*  See also: TBeff, HYPeff, HAeff */
    /*  */
    /*  References: */
    /*   */
    /*  Maronna, R.A., Martin D. and Yohai V.J. (2006), "Robust Statistics,
     * Theory */
    /*  and Methods", Wiley, New York. */
    /*  */
    /*  */
    /*  Copyright 2008-2021. */
    /*  Written by FSDA team */
    /*  */
    /*  */
    /* <a href="matlab: docsearchFS('OPTeff')">Link to the help page for this
     * function</a> */
    /*  */
    /* $LastChangedDate::                      $: Date of the last commit */
    /*  */
    /*  Examples: */
    /*  */
    /* { */
    /*     % Find c given a value of efficiency. */
    /*     % The constant c associated to a nominal location efficiency of 95%
     * in regression is */
    /*     % c = 3.180662196584308 */
    /*     c=OPTeff(0.95,1) */
    /* } */
    /*  */
    /* { */
    /*     % Find the value of c for efficiency which goes to 1. */
    /*     ef=0.75:0.01:0.99; */
    /*     CC=[ef' zeros(length(ef),1)]; */
    /*     jk=0; */
    /*     for j=ef */
    /*         jk=jk+1; */
    /*         CC(jk,2)=OPTeff(j,1); */
    /*     end */
    /*  */
    /* } */
    /*  Beginning of code */
    /*  LOCATION EFFICIENCY */
    b_c = 2.0;
    /*  c = starting point of the iteration */
    /*  Remark: the more refined approximation for the starting value of */
    /*  sqrt(chi2inv(eff,p))+2; does not seem to be necessary in the case of */
    /*  location efficiency */
    /*  step = width of the dichotomic search (it decreases by half at each */
    /*  iteration). */
    b_step = 10.0;
    /*      p4=(p+4)*(p+2); */
    /*      p6=(p+6)*(p+4)*(p+2); */
    /*      p8=(p+8)*(p+6)*(p+4)*(p+2); */
    /*  Coefficients of optimal psi standardized using intervals  */
    /*  0---(2/3)c , (2/3)c---c, >c   */
    /*  Epsisq = E( \psi(x)^2)  */
    /*  Epsidivx = E( \psi(x)/x) */
    /*  Epsider = E( \psi'(x)) */
    /*  bet=(1-1/p)*Epsidivx+(1/p)*Epsider;    */
    /*  [var (robust estimator of location using optimal rho function)] =
     * (Epsisq/p) / (bet^2) */
    F = 10.0;
    while (fabs(F - varargin_2) > 1.0E-12) {
      F = b_c * b_c;
      b = F / 2.0;
      a = 2.0 * F / 9.0;
      bet_tmp = gammainc(a, 1.5);
      a_tmp_tmp = gammainc(a, 0.5);
      b2 = rt_powd_snf(b_c, 4.0);
      B2 = rt_powd_snf(b_c, 6.0);
      ctun = rt_powd_snf(b_c, 8.0);
      a_tmp = (gammainc(b, 1.5)).re - bet_tmp.re;
      F = 2.7692 / F * a_tmp_tmp.re +
          -5.3834 / F * ((gammainc(b, 0.5)).re - a_tmp_tmp.re);
      iter = (gammainc(b, 2.5)).re - (gammainc(a, 2.5)).re;
      a2 = (gammainc(b, 3.5)).re - (gammainc(a, 3.5)).re;
      b_a = 0.0 * (((F + 43.0672 / b2 * a_tmp) + -69.984 / B2 * 3.0 * iter) +
                   32.3 / ctun * 5.0 * 3.0 * a2) +
            (((F + 129.20159999999998 / b2 * a_tmp) +
              -349.91999999999996 / B2 * 3.0 * iter) +
             226.09999999999997 / ctun * 5.0 * 3.0 * a2);
      F = b_a * b_a /
          ((((((((7.66846864 / b2 * bet_tmp.re + 28.98099556 / b2 * a_tmp) +
                 1854.78371584 / ctun * 5.0 * 3.0 * a2) +
                7679.901376 / rt_powd_snf(b_c, 12.0) * 9.0 * 7.0 * 5.0 * 3.0 *
                    ((gammainc(b, 5.5)).re - (gammainc(a, 5.5)).re)) +
               1043.2899999999997 / rt_powd_snf(b_c, 16.0) * 13.0 * 11.0 * 9.0 *
                   7.0 * 5.0 * 3.0 *
                   ((gammainc(b, 7.5)).re - (gammainc(a, 7.5)).re)) +
              -463.69592896 / B2 * 3.0 * iter) +
             753.5037312 / ctun * 5.0 * 3.0 * a2) +
            -6375.7974896 / rt_powd_snf(b_c, 10.0) * 7.0 * 5.0 * 3.0 *
                ((gammainc(b, 4.5)).re - (gammainc(a, 4.5)).re)) +
           -4520.9663999999993 / rt_powd_snf(b_c, 14.0) * 11.0 * 9.0 * 7.0 *
               5.0 * 3.0 * ((gammainc(b, 6.5)).re - (gammainc(a, 6.5)).re));
      b_step *= 0.5;
      /*  disp([step c empeff]) */
      if (F < varargin_2) {
        b_c += b_step;
      } else if (F > varargin_2) {
        b_c = fmax(b_c - b_step, 0.1);
      }
      /*  disp([step c empeff]) */
    }
    /*  Remark: */
    /*  chi2cdf(x,v) = gamcdf(x,v/2,2) = gammainc(x ./ 2, v/2); */
    i = c->size[0] * c->size[1];
    c->size[0] = 1;
    c->size[1] = 1;
    emxEnsureCapacity_real_T(c, i);
    c->data[0] = b_c / 3.0;
    psifunc_class_size[0] = 1;
    psifunc_class_size[1] = 3;
    psifunc_class_data[0] = 'O';
    psifunc_class_data[1] = 'P';
    psifunc_class_data[2] = 'T';
    out->rhofuncparam->size[0] = 0;
    out->rhofuncparam->size[1] = 0;
  } else if (n_strcmp(varargin_6)) {
    if ((varargin_8->size[0] == 0) || (varargin_8->size[1] == 0)) {
      F = 4.5;
    } else {
      F = varargin_8->data[0];
      /*  Instruction necessary for Ccoder */
    }
    i = out->rhofuncparam->size[0] * out->rhofuncparam->size[1];
    out->rhofuncparam->size[0] = 1;
    out->rhofuncparam->size[1] = 1;
    emxEnsureCapacity_real_T(out->rhofuncparam, i);
    out->rhofuncparam->data[0] = F;
    /*  Use (if possible) precalculated values of c,A,b,d and kc */
    for (k = 0; k < 50; k++) {
      varargin_1[k] = fabs(varargin_2 - EFF[k]);
    }
    e_minimum(varargin_1, &iter, &nx);
    b_varargin_1[0] = fabs(F - 4.0);
    b_varargin_1[1] = fabs(F - 4.5);
    b_varargin_1[2] = fabs(F - 5.0);
    f_minimum(b_varargin_1, &a2, &k);
    if ((iter < 1.0E-6) && (a2 < 1.0E-6)) {
      /*  Load precalculated values of tuning constants */
      for (i = 0; i < 5; i++) {
        row[i] = b_dv[((nx + 50 * (i + 1)) + 300 * (k - 1)) - 1];
      }
      c2 = row[0];
      b2 = row[2];
      B2 = row[3];
      ctun = row[4];
      /*      if kdef == 4 && eff==0.85 */
      /*          c2 =3.212800979614258; */
      /*          A2 =0.570183575755717; */
      /*          B2 =0.696172437281084; */
      /*          d2 =1.205900263786317; */
      /*      elseif kdef == 4.5 && eff==0.85 */
      /*          c2 =3.032387733459473; */
      /*          A2 =0.615717108822885; */
      /*          B2 = 0.723435958485131; */
      /*          d2 =1.321987605094910; */
      /*      elseif kdef == 5 && eff==0.85 */
      /*          c2 =2.911890029907227; */
      /*          A2 =0.650228046997054; */
      /*          B2 =0.743433840145084; */
      /*          d2 =1.419320821762087; */
      /*           */
      /*      elseif kdef == 4 && eff==0.90 */
      /*          c2 =3.544333040714264; */
      /*          A2 =0.655651252372878; */
      /*          B2 =0.768170638356071; */
      /*          d2 =1.330560147762300; */
      /*      elseif kdef == 4.5 && eff==0.90 */
      /*          c2 =3.313891947269440; */
      /*          A2 =0.697965573395585; */
      /*          B2 =0.792571144662011; */
      /*          d2 =1.452220833301545; */
      /*      elseif kdef == 5 && eff==0.90 */
      /*          c2 =3.167660615756176; */
      /*          A2 =0.729727894789617; */
      /*          B2 =0.810404284656104; */
      /*          d2 =1.5553258180618305; */
      /*           */
      /*      elseif kdef == 4 && eff==0.95 */
      /*          c2 =4.331634521484375; */
      /*          A2 =0.754327484845243; */
      /*          B2 =0.846528826589308; */
      /*          d2 =1.480099129676819; */
      /*      elseif kdef == 4.5 && eff==0.95 */
      /*          c2 =3.866390228271484; */
      /*          A2 =0.791281464739131; */
      /*          B2 =0.867016329355630; */
      /*          d2 =1.610621500015260; */
      /*      elseif kdef == 5 && eff==0.95 */
      /*          c2 =3.629499435424805; */
      /*          A2 =0.818876452066880; */
      /*          B2 =0.882004888111327; */
      /*          d2 =1.723768949508668; */
    }
    psifunc_class_size[0] = 1;
    psifunc_class_size[1] = 3;
    psifunc_class_data[0] = 'H';
    psifunc_class_data[1] = 'Y';
    psifunc_class_data[2] = 'P';
    i = c->size[0] * c->size[1];
    c->size[0] = 1;
    c->size[1] = 5;
    emxEnsureCapacity_real_T(c, i);
    c->data[0] = c2;
    c->data[1] = F;
    c->data[2] = b2;
    c->data[3] = B2;
    c->data[4] = ctun;
  } else if (o_strcmp(varargin_6)) {
    if ((varargin_8->size[0] == 0) || (varargin_8->size[1] == 0)) {
      i = out->rhofuncparam->size[0] * out->rhofuncparam->size[1];
      out->rhofuncparam->size[0] = 1;
      out->rhofuncparam->size[1] = 3;
      emxEnsureCapacity_real_T(out->rhofuncparam, i);
      out->rhofuncparam->data[0] = 2.0;
      out->rhofuncparam->data[1] = 4.0;
      out->rhofuncparam->data[2] = 8.0;
    } else {
      i = out->rhofuncparam->size[0] * out->rhofuncparam->size[1];
      out->rhofuncparam->size[0] = varargin_8->size[0];
      out->rhofuncparam->size[1] = 1;
      emxEnsureCapacity_real_T(out->rhofuncparam, i);
      nx = varargin_8->size[0];
      for (i = 0; i < nx; i++) {
        out->rhofuncparam->data[i] = varargin_8->data[i];
      }
    }
    /*  Compute tuning constant associated to the requested nominal efficiency
     */
    /*  c2 = consistency factor for a given value of efficiency */
    /* HAeff finds the tuning constant that guarrantees a requested asymptotic
     * efficiency */
    /*  */
    /* <a href="matlab: docsearchFS('HAeff')">Link to the help function</a> */
    /*  */
    /*   Required input arguments: */
    /*  */
    /*     eff:       efficiency. Scalar.  Scalar which contains the required */
    /*                efficiency (of location or scale estimator). */
    /*                Generally eff=0.85, 0.9 or 0.95. */
    /*     v :        number of response variables. Scalar. Number of variables
     * of */
    /*                the  dataset (for regression v=1) */
    /*                UP TO NOW v=1 (JUST REGRESSION) TO DO FOR MULTIVARIATE */
    /*                ANALYSIS */
    /*  */
    /*  */
    /*   Optional input arguments: */
    /*  */
    /*      abc     : parameters of Hampel estimator. Vector. Vector of length 3
     */
    /*                which contains the parameters of Hampel estimator. If */
    /*                vector abc is not specified it is set equal to [2, 4, 8]
     */
    /*                Example - [1.5,3.5,8] */
    /*                Data Types - double */
    /*  */
    /*  */
    /*  Output: */
    /*  */
    /*   ceff : Requested tuning constant. Scalar. Tuning constatnt of Hampel
     * rho */
    /*          function associated to requested value of efficiency */
    /*  */
    /*  */
    /*  More About: */
    /*  */
    /*  Function HApsi transforms vector u as follows. */
    /*   \[ */
    /*   HApsi(u)  = \left\{ */
    /*   \begin{array}{cc} */
    /*     u & |u| <= a                                       \\ */
    /*     a \times sign(u) & a <= |u| < b                    \\ */
    /*     a \frac{c-|u|}{c-b} \times sign(u) & b <= |u| <  c \\ */
    /*     0 & |u| >= c */
    /*   \end{array} \right. */
    /*  \] */
    /*  */
    /*              where $a$= ctun *param(1). */
    /*                    $b$= ctun *param(2). */
    /*                    $c$= ctun *param(3). */
    /*  */
    /*              The default is */
    /*                    $a$= 2*ctun. */
    /*                    $b$= 4*ctun. */
    /*                    $c$= 8*ctun. */
    /*  */
    /* 	It is necessary to have 0 <= a <= b <= c. */
    /*  */
    /*  Parameter ctun multiplies parameters (a,b,c) of Hampel estimator. */
    /*  */
    /*  */
    /*  See also: TBeff, HYPeff, OPTeff, RKeff, HUeff */
    /*  */
    /*  References: */
    /*  */
    /*  Hoaglin, D.C., Mosteller, F., Tukey, J.W. (1982), "Understanding Robust
     * and */
    /*  Exploratory Data Analysis", Wiley, New York. */
    /*  */
    /*  */
    /*  Copyright 2008-2021. */
    /*  Written by FSDA team */
    /*  */
    /*  */
    /* <a href="matlab: docsearchFS('HAeff')">Link to the help page for this
     * function</a> */
    /*  */
    /* $LastChangedDate::                      $: Date of the last commit */
    /*  */
    /*  */
    /*  */
    /*  Examples: */
    /*  */
    /* { */
    /*     % Find c for fixed efficiency. */
    /*     % The constant c associated to a nominal location efficiency of 95%
     * in regression is */
    /*     % c = 0.690998716841394 */
    /*     c=HAeff(0.95,1) */
    /* } */
    /* { */
    /*     % Example where three input parameters are supplied. */
    /*     % Find constant c associated to a nominal location efficiency of 95
     * per */
    /*     % cent in regression when tun=[1.5,3.5,8]. */
    /*      tun=[1.5,3,8]; */
    /*     c=HAeff(0.95,1,tun); */
    /* } */
    /*  */
    /*  */
    /*  Beginning of code */
    /*  LOCATION EFFICIENCY */
    /*  ctun = starting point of the iteration */
    ctun = 0.57;
    /*  c = starting point of the iteration */
    /*  Remark: the more refined approximation for the starting value of */
    /*  sqrt(chi2inv(eff,p))+2; does not seem to be necessary in the case of */
    /*  location efficiency */
    /*  step = width of the dichotomic search (it decreases by half at each */
    /*  iteration). */
    b_step = 0.5;
    /*  Convergence condition is */
    /*   ....... */
    /*  ctun=(0:0.01:1)'; */
    F = 1.0;
    while (fabs(F - varargin_2) > 1.0E-14) {
      a = out->rhofuncparam->data[0] * ctun;
      b = out->rhofuncparam->data[1] * ctun;
      b_c = out->rhofuncparam->data[2] * ctun;
      iter = a * a;
      a2 = iter / 2.0;
      b2 = b * b / 2.0;
      B2 = b_c * b_c;
      c2 = B2 / 2.0;
      /*  bet  = \int  \psi'(x) d \Phi(x) */
      /*  bet = \int_-a^a d \Phi(x) +2* \int_b^c -a/(c-b) */
      b_a_tmp = gammainc(b2, 0.5);
      c_a_tmp = gammainc(c2, 0.5);
      bet_tmp = gammainc(a2, 0.5);
      /*  alph = \int \psi^2(x) d \Phi(x) */
      a_tmp = b_c - b;
      b_a = a / a_tmp;
      /*                                         % 2* \int_0^a x^2 f(x) dx */
      /*                      % 2* a^2 \int_a^b f(x) dx */
      /*     %(a./(c-b)).^2 (2 c^2 \int_b^c f(x) dx */
      /*                 %   + 2*  \int_b^c x^2 f(x) dx */
      /*  +2 *2* \int_b^c |x| f(x) */
      /*  Remark: if v=1 */
      /*  -2*c*v*sqrt(2/pi)*(gammainc(c2,(v+1)/2)-gammainc(b2,(v+1)/2))); */
      /*      -4*c.*(normpdf(b)-normpdf(c))  ); */
      /*  empeff = bet^2/alph = 1 / [var (robust estimator of location)] */
      b = (b_a_tmp.re - c_a_tmp.re) * a;
      if ((b_a_tmp.im - c_a_tmp.im) * a == 0.0) {
        F = b / a_tmp;
      } else if (b == 0.0) {
        F = 0.0;
      } else {
        F = b / a_tmp;
      }
      a = bet_tmp.re + F;
      F = a * a /
          (((gammainc(a2, 1.5)).re + iter * (b_a_tmp.re - bet_tmp.re)) +
           b_a * b_a *
               ((B2 * (c_a_tmp.re - b_a_tmp.re) +
                 ((gammainc(c2, 1.5)).re - (gammainc(b2, 1.5)).re)) -
                2.0 * b_c * 0.79788456080286541 *
                    ((gammainc(c2, 1.0)).re - (gammainc(b2, 1.0)).re)));
      b_step /= 2.0;
      if (F < varargin_2) {
        ctun += b_step;
      } else if (F > varargin_2) {
        ctun = fmax(ctun - b_step, 0.01);
      }
      /*  disp([empeff eff ctun]) */
    }
    /*  Remark: */
    /*  chi2cdf(x,v) = gamcdf(x,v/2,2) = gammainc(x ./ 2, v/2); */
    psifunc_class_size[0] = 1;
    psifunc_class_size[1] = 2;
    psifunc_class_data[0] = 'H';
    psifunc_class_data[1] = 'A';
    i = c->size[0] * c->size[1];
    c->size[0] = 1;
    c->size[1] = (signed char)out->rhofuncparam->size[1] + 1;
    emxEnsureCapacity_real_T(c, i);
    c->data[0] = ctun;
    nx = (signed char)out->rhofuncparam->size[1];
    for (i = 0; i < nx; i++) {
      c->data[i + 1] = out->rhofuncparam->data[i];
    }
  } else if (p_strcmp(varargin_6)) {
    /*  Compute tuning constant associated to the requested nominal efficiency
     */
    /*  c = consistency factor for a given value of efficiency */
    /* PDeff finds the constant alpha which is associated to the requested
     * efficiency for minimum power divergence estimator */
    /*  */
    /*  */
    /*  */
    /* <a href="matlab: docsearchFS('PDeff')">Link to the help function</a> */
    /*  */
    /*  */
    /*   Required input arguments: */
    /*  */
    /*     eff:       required efficienty. Scalar. */
    /*                Scalar which contains the required efficiency (of location
     */
    /*                or scale estimator). */
    /*                Generally eff=0.85, 0.9 or 0.95 */
    /*                Data Types - single|double */
    /*  */
    /*   Optional input arguments: */
    /*  */
    /*  */
    /*  */
    /*  Output: */
    /*  */
    /*   alpha : Requested tuning constant. Scalar. Tuning constant for minimum
     */
    /*            power divergence estimator associated to requested value of */
    /*            efficiency */
    /*  */
    /*  See also: TBeff, OPTeff, HYPeff, HAeff */
    /*  */
    /*  References: */
    /*  */
    /*   Riani, M. Atkinson, A.C., Corbellini A. and Perrotta A. (2020), Robust
     */
    /*   Regression with Density Power Divergence: Theory, Comparisons and Data
     */
    /*   Analysis, submitted. */
    /*  */
    /*  Copyright 2008-2021. */
    /*  Written by FSDA team */
    /*  */
    /*  */
    /* <a href="matlab: docsearchFS('PDeff')">Link to the help page for this
     * function</a> */
    /*  */
    /* $LastChangedDate::                      $: Date of the last commit */
    /*  */
    /*  */
    /*  Examples: */
    /*  */
    /* { */
    /*     % Find tuning constant alpha for a given efficiency. */
    /*     % The constant alpha associated to a nominal location efficiency of
     * 95% in regression is */
    /*     % alpha= 0.224515798935881 */
    /*     c=PDeff(0.95); */
    /* } */
    /*  */
    /*  */
    /*  Beginning of code */
    F = rt_powd_snf(varargin_2, 0.66666666666666663);
    /*  Alternative more complicated way to find alpha */
    /*  F=eff^2; */
    /*  coeff=[F, 6*F, 15*F, 20*F-8, 15*F-12, 6*F-6, F-1]; */
    /*  r=roots(coeff); */
    /*  r = r(imag(r)==0); % Save only the real roots */
    /*  alpha = r(r>0); */
    psifunc_class_size[0] = 1;
    psifunc_class_size[1] = 2;
    psifunc_class_data[0] = 'P';
    psifunc_class_data[1] = 'D';
    i = c->size[0] * c->size[1];
    c->size[0] = 1;
    c->size[1] = 1;
    emxEnsureCapacity_real_T(c, i);
    c->data[0] = ((1.0 - F) + sqrt(1.0 - F)) / F;
    out->rhofuncparam->size[0] = 0;
    out->rhofuncparam->size[1] = 0;
  }
  emxInit_real_T(&b1, 1);
  iter = 0.0;
  F = rtInf;
  i = b1->size[0];
  b1->size[0] = b0->size[0];
  emxEnsureCapacity_real_T(b1, i);
  nx = b0->size[0];
  for (i = 0; i < nx; i++) {
    b1->data[i] = b0->data[i];
  }
  i = out->beta->size[0];
  out->beta->size[0] = b0->size[0];
  emxEnsureCapacity_real_T(out->beta, i);
  nx = b0->size[0];
  for (i = 0; i < nx; i++) {
    out->beta->data[i] = b0->data[i];
  }
  i = out->weights->size[0] * out->weights->size[1];
  out->weights->size[0] = y->size[0];
  out->weights->size[1] = 1;
  emxEnsureCapacity_real_T(out->weights, i);
  nx = y->size[0];
  for (i = 0; i < nx; i++) {
    out->weights->data[i] = y->data[i];
  }
  /*  MATLAB Ccoder initialization */
  emxInit_real_T(&b_y, 1);
  emxInit_real_T(&x, 2);
  emxInit_int32_T(&r, 1);
  emxInit_boolean_T(&c_y, 1);
  emxInit_real_T(&r1, 2);
  while ((iter <= varargin_10) && (F > varargin_12)) {
    mtimes(X, b1, out->beta);
    i = out->beta->size[0];
    out->beta->size[0] = y->size[0];
    emxEnsureCapacity_real_T(out->beta, i);
    nx = y->size[0];
    for (i = 0; i < nx; i++) {
      out->beta->data[i] = (y->data[i] - out->beta->data[i]) / auxscale;
    }
    nx = out->beta->size[0];
    i = b_y->size[0];
    b_y->size[0] = out->beta->size[0];
    emxEnsureCapacity_real_T(b_y, i);
    for (k = 0; k < nx; k++) {
      b_y->data[k] = fabs(out->beta->data[k]);
    }
    i = c_y->size[0];
    c_y->size[0] = b_y->size[0];
    emxEnsureCapacity_boolean_T(c_y, i);
    nx = b_y->size[0];
    for (i = 0; i < nx; i++) {
      c_y->data[i] = (b_y->data[i] <= 2.2204460492503131E-16);
    }
    b_eml_find(c_y, r);
    i = out->residuals->size[0];
    out->residuals->size[0] = r->size[0];
    emxEnsureCapacity_real_T(out->residuals, i);
    nx = r->size[0];
    for (i = 0; i < nx; i++) {
      out->residuals->data[i] = r->data[i];
    }
    if (out->residuals->size[0] != 0) {
      i = r->size[0];
      r->size[0] = out->residuals->size[0];
      emxEnsureCapacity_int32_T(r, i);
      nx = out->residuals->size[0];
      for (i = 0; i < nx; i++) {
        r->data[i] = (int)out->residuals->data[i];
      }
      nx = r->size[0];
      for (i = 0; i < nx; i++) {
        out->beta->data[r->data[i] - 1] = 2.2204460492503131E-16;
      }
    }
    /*  w is the weight vector \psi(x)/x Each observations receives a */
    /*  weight. Units associated to outliers tend to have 0 weight */
    /*  OLD INSTRUCTION */
    /*  w=TBwei(r1,c); */
    b_bool = false;
    if (psifunc_class_size[1] == 2) {
      nx = 0;
      do {
        exitg1 = 0;
        if (nx < 2) {
          if (psifunc_class_data[nx] != cv1[nx]) {
            exitg1 = 1;
          } else {
            nx++;
          }
        } else {
          b_bool = true;
          exitg1 = 1;
        }
      } while (exitg1 == 0);
    }
    if (b_bool) {
      TBwei(out->beta, (double *)c->data, out->residuals);
      k = out->residuals->size[0];
      i = out->weights->size[0] * out->weights->size[1];
      out->weights->size[0] = out->residuals->size[0];
      out->weights->size[1] = 1;
      emxEnsureCapacity_real_T(out->weights, i);
      for (i = 0; i < 1; i++) {
        for (nx = 0; nx < k; nx++) {
          out->weights->data[nx] = out->residuals->data[nx];
        }
      }
    } else {
      b_bool = false;
      if (psifunc_class_size[1] == 3) {
        nx = 0;
        do {
          exitg1 = 0;
          if (nx < 3) {
            if (psifunc_class_data[nx] != cv2[nx]) {
              exitg1 = 1;
            } else {
              nx++;
            }
          } else {
            b_bool = true;
            exitg1 = 1;
          }
        } while (exitg1 == 0);
      }
      if (b_bool) {
        OPTwei(out->beta, (double *)c->data, *(int(*)[2])c->size, out->weights);
      } else {
        b_bool = false;
        if (psifunc_class_size[1] == 2) {
          nx = 0;
          do {
            exitg1 = 0;
            if (nx < 2) {
              if (psifunc_class_data[nx] != cv3[nx]) {
                exitg1 = 1;
              } else {
                nx++;
              }
            } else {
              b_bool = true;
              exitg1 = 1;
            }
          } while (exitg1 == 0);
        }
        if (b_bool) {
          HAwei(out->beta, (double *)c->data, *(int(*)[2])c->size,
                out->residuals);
          k = out->residuals->size[0];
          i = out->weights->size[0] * out->weights->size[1];
          out->weights->size[0] = out->residuals->size[0];
          out->weights->size[1] = 1;
          emxEnsureCapacity_real_T(out->weights, i);
          for (i = 0; i < 1; i++) {
            for (nx = 0; nx < k; nx++) {
              out->weights->data[nx] = out->residuals->data[nx];
            }
          }
        } else if (t_strcmp(psifunc_class_data, psifunc_class_size)) {
          HYPwei(out->beta, (double *)c->data, *(int(*)[2])c->size,
                 out->residuals);
          k = out->residuals->size[0];
          i = out->weights->size[0] * out->weights->size[1];
          out->weights->size[0] = out->residuals->size[0];
          out->weights->size[1] = 1;
          emxEnsureCapacity_real_T(out->weights, i);
          for (i = 0; i < 1; i++) {
            for (nx = 0; nx < k; nx++) {
              out->weights->data[nx] = out->residuals->data[nx];
            }
          }
        } else if (u_strcmp(psifunc_class_data, psifunc_class_size)) {
          /* PDwei computes weight function psi(u)/u for  for minimum density
           * power divergence estimator   */
          /*  */
          /* <a href="matlab: docsearchFS('PDwei')">Link to the help
           * function</a> */
          /*  */
          /*  */
          /*  Required input arguments: */
          /*  */
          /*     u:         scaled residuals or Mahalanobis distances. Vector. n
           * x 1 */
          /*                vector containing residuals or Mahalanobis distances
           */
          /*                for the n units of the sample */
          /*     alpha :    tuning parameter. Scalar. Scalar in the interval
           * (0,1] which */
          /*                controls the robustness/efficiency of the estimator
           */
          /*                (beta in regression or mu in the location case ...).
           * The */
          /*                greater is alpha the greater is the bdp and smaller
           * is the */
          /*                efficiency. */
          /*  */
          /*   Optional input arguments: */
          /*  */
          /*   Output: */
          /*  */
          /*     w :         n x 1 vector which contains the Tukey's biweight
           * weights */
          /*                 associated to the scaled residuals or Mahalanobis
           */
          /*                 distances for the n units of the sample. */
          /*  */
          /*  More About: */
          /*  */
          /*  function PDwei transforms vector u as follows */
          /*  \[ */
          /*  PDwei(u,alpha)=  \alpha \exp(-\alpha (u^2/2)); */
          /*       \] */
          /*  */
          /*  */
          /*  */
          /*  */
          /*  See also: TBwei, HYPwei, HAwei, OPTwei */
          /*  */
          /*  References: */
          /*  */
          /*   Riani, M. Atkinson, A.C., Corbellini A. and Perrotta A. (2020),
           * Robust */
          /*   Regression with Density Power Divergence: Theory, Comparisons and
           * Data */
          /*   Analysis, submitted. */
          /*  */
          /*  */
          /*  Copyright 2008-2021. */
          /*  Written by FSDA team */
          /*  */
          /*  */
          /* <a href="matlab: docsearchFS('PDwei')">Link to the help page for
           * this function</a> */
          /*  */
          /* $LastChangedDate::                      $: Date of the last commit
           */
          /*  Examples: */
          /* { */
          /*     % Weight function for minimum density power divergence
           * estimator. */
          /*     x=-6:0.01:6; */
          /*     alpha=0.01; */
          /*     weiPD=PDwei(x,alpha); */
          /*     plot(x,weiPD) */
          /*     xlabel('x','Interpreter','Latex') */
          /*     ylabel('$W (x) =\psi(x)/x$','Interpreter','Latex') */
          /*  */
          /* } */
          /* { */
          /*     % Comparing two weight functions for two values of bdp. */
          /*     close all */
          /*     x=-6:0.01:6; */
          /*     lwd=2; */
          /*     hold('on') */
          /*     bdp1=0.25; */
          /*     alpha1=PDbdp(bdp1);     */
          /*     weiPD=PDwei(x,alpha1); */
          /*     weiPD=weiPD/max(weiPD); */
          /*     plot(x,weiPD,'LineStyle','-','LineWidth',lwd) */
          /*     bdp2=0.01; */
          /*     c=PDbdp(bdp2); */
          /*     weiPD=PDwei(x,c); */
          /*     weiPD=weiPD/max(weiPD); */
          /*     plot(x,weiPD,'LineStyle','-.','LineWidth',lwd) */
          /*     xlabel('$x$','Interpreter','Latex','FontSize',16) */
          /*     ylabel('PD weight function
           * $\psi_\alpha(x)/x$','Interpreter','Latex','FontSize',20) */
          /*     legend({['bdp=' num2str(bdp1,2)],  ['bdp='
           * num2str(bdp2,2)]},... */
          /*     'Interpreter','Latex','Location','SouthEast','FontSize',12) */
          /* } */
          /* { */
          /*     %% Compare five different weight functions in each of them eff
           * is 95 per cent. */
          /*     % Initialize graphical parameters. */
          /*     FontSize=14; */
          /*     x=-6:0.01:6; */
          /*     ylim1=-0.05; */
          /*     ylim2=1.05; */
          /*     xlim1=min(x); */
          /*     xlim2=max(x); */
          /*     LineWidth=2; */
          /*  */
          /*     subplot(2,3,1) */
          /*     ceff095HU=HUeff(0.95,1); */
          /*     weiHU=HUwei(x,ceff095HU); */
          /*     plot(x,weiHU,'LineWidth',LineWidth) */
          /*     xlabel('$u$','Interpreter','Latex','FontSize',FontSize) */
          /*     title('Huber','FontSize',FontSize) */
          /*     ylim([ylim1 ylim2]) */
          /*     xlim([xlim1 xlim2]) */
          /*  */
          /*     subplot(2,3,2) */
          /*     ceff095HA=HAeff(0.95,1); */
          /*     weiHA=HAwei(x,ceff095HA); */
          /*     plot(x,weiHA,'LineWidth',LineWidth) */
          /*     xlabel('$u$','Interpreter','Latex','FontSize',FontSize) */
          /*     title('Hampel','FontSize',FontSize) */
          /*     ylim([ylim1 ylim2]) */
          /*     xlim([xlim1 xlim2]) */
          /*  */
          /*  */
          /*     subplot(2,3,3) */
          /*     ceff095TB=TBeff(0.95,1); */
          /*     weiTB=TBwei(x,ceff095TB); */
          /*     plot(x,weiTB,'LineWidth',LineWidth) */
          /*     xlabel('$u$','Interpreter','Latex','FontSize',FontSize) */
          /*     title('Tukey biweight','FontSize',FontSize) */
          /*     ylim([ylim1 ylim2]) */
          /*     xlim([xlim1 xlim2]) */
          /*  */
          /*     subplot(2,3,4) */
          /*     ceff095HYP=HYPeff(0.95,1); */
          /*     ktuning=4.5; */
          /*     weiHYP=HYPwei(x,[ceff095HYP,ktuning]); */
          /*     plot(x,weiHYP,'LineWidth',LineWidth) */
          /*     xlabel('$u$','Interpreter','Latex','FontSize',FontSize) */
          /*     title('Hyperbolic','FontSize',FontSize) */
          /*     ylim([ylim1 ylim2]) */
          /*     xlim([xlim1 xlim2]) */
          /*  */
          /*     subplot(2,3,5) */
          /*     ceff095PD=PDeff(0.95); */
          /*     weiPD=PDwei(x,ceff095PD); */
          /*     weiPD=weiPD/max(weiPD); */
          /*     plot(x,weiPD,'LineWidth',LineWidth) */
          /*     xlabel('$u$','Interpreter','Latex','FontSize',FontSize) */
          /*     title('Power divergence','FontSize',FontSize) */
          /*     ylim([ylim1 ylim2]) */
          /*     xlim([xlim1 xlim2]) */
          /* } */
          /*  Beginning of code */
          /*  normalized wights in such a way that when u=0 w=1 */
          i = b_y->size[0];
          b_y->size[0] = out->beta->size[0];
          emxEnsureCapacity_real_T(b_y, i);
          nx = out->beta->size[0];
          for (k = 0; k < nx; k++) {
            b_y->data[k] = out->beta->data[k] * out->beta->data[k];
          }
          b_c = 0.0;
          nx = c->size[1];
          for (i = 0; i < nx; i++) {
            b_c += -c->data[i] * (b_y->data[i] / 2.0);
          }
          /*  Unnormalized weights are */
          /*  w = alpha * exp(- alpha *(u.^2/2)); */
          i = out->weights->size[0] * out->weights->size[1];
          out->weights->size[0] = 1;
          out->weights->size[1] = 1;
          emxEnsureCapacity_real_T(out->weights, i);
          out->weights->data[0] = exp(b_c);
        }
      }
    }
    /*  Every column of matrix X and vector y is multiplied by the sqrt root of
     * the n x 1 */
    /*  weight vector w, then weighted regression is performed */
    i = x->size[0] * x->size[1];
    x->size[0] = out->weights->size[0];
    x->size[1] = out->weights->size[1];
    emxEnsureCapacity_real_T(x, i);
    nx = out->weights->size[0] * out->weights->size[1];
    for (i = 0; i < nx; i++) {
      x->data[i] = out->weights->data[i];
    }
    nx = out->weights->size[0] * out->weights->size[1];
    for (k = 0; k < nx; k++) {
      x->data[k] = sqrt(x->data[k]);
    }
    /*  b2 = inv(X'W*X)*X'W*y where W=w*ones(1,k) */
    i = b_y->size[0];
    b_y->size[0] = y->size[0];
    emxEnsureCapacity_real_T(b_y, i);
    nx = y->size[0];
    for (i = 0; i < nx; i++) {
      b_y->data[i] = y->data[i] * x->data[i];
    }
    b_bsxfun(X, x, r1);
    mldivide(r1, b_y, out->beta);
    /*  disp([b2-b22]) */
    i = b1->size[0];
    b1->size[0] = out->beta->size[0];
    emxEnsureCapacity_real_T(b1, i);
    nx = out->beta->size[0];
    for (i = 0; i < nx; i++) {
      b1->data[i] = out->beta->data[i] - b1->data[i];
    }
    nx = b1->size[0];
    i = b_y->size[0];
    b_y->size[0] = b1->size[0];
    emxEnsureCapacity_real_T(b_y, i);
    for (k = 0; k < nx; k++) {
      b_y->data[k] = fabs(b1->data[k]);
    }
    F = b_maximum(b_y);
    iter++;
    i = b1->size[0];
    b1->size[0] = out->beta->size[0];
    emxEnsureCapacity_real_T(b1, i);
    nx = out->beta->size[0];
    for (i = 0; i < nx; i++) {
      b1->data[i] = out->beta->data[i];
    }
  }
  emxFree_real_T(&r1);
  emxFree_int32_T(&r);
  emxFree_real_T(&x);
  emxFree_real_T(&b1);
  for (i = 0; i < 5; i++) {
    out->class[i] = b_cv[i];
  }
  mtimes(X, out->beta, out->residuals);
  i = out->residuals->size[0];
  out->residuals->size[0] = y->size[0];
  emxEnsureCapacity_real_T(out->residuals, i);
  nx = y->size[0];
  for (i = 0; i < nx; i++) {
    out->residuals->data[i] = (y->data[i] - out->residuals->data[i]) / auxscale;
  }
  /*  Store in output structure the outliers found with confidence level conflev
   */
  /*  which has been usedto declared the outliers */
  if (X->size[0] < 1) {
    c->size[0] = 1;
    c->size[1] = 0;
  } else {
    i = c->size[0] * c->size[1];
    c->size[0] = 1;
    c->size[1] = X->size[0];
    emxEnsureCapacity_real_T(c, i);
    nx = X->size[0] - 1;
    for (i = 0; i <= nx; i++) {
      c->data[i] = (double)i + 1.0;
    }
  }
  F = sqrt(c_chi2inv(varargin_14));
  nx = out->residuals->size[0];
  i = b_y->size[0];
  b_y->size[0] = out->residuals->size[0];
  emxEnsureCapacity_real_T(b_y, i);
  for (k = 0; k < nx; k++) {
    b_y->data[k] = fabs(out->residuals->data[k]);
  }
  i = c_y->size[0];
  c_y->size[0] = b_y->size[0];
  emxEnsureCapacity_boolean_T(c_y, i);
  nx = b_y->size[0];
  for (i = 0; i < nx; i++) {
    c_y->data[i] = (b_y->data[i] > F);
  }
  emxFree_real_T(&b_y);
  nx = c_y->size[0] - 1;
  k = 0;
  for (i = 0; i <= nx; i++) {
    if (c_y->data[i]) {
      k++;
    }
  }
  emxInit_int32_T(&r2, 1);
  i = r2->size[0];
  r2->size[0] = k;
  emxEnsureCapacity_int32_T(r2, i);
  k = 0;
  for (i = 0; i <= nx; i++) {
    if (c_y->data[i]) {
      r2->data[k] = i + 1;
      k++;
    }
  }
  emxFree_boolean_T(&c_y);
  i = out->outliers->size[0] * out->outliers->size[1];
  out->outliers->size[0] = 1;
  out->outliers->size[1] = r2->size[0];
  emxEnsureCapacity_real_T(out->outliers, i);
  nx = r2->size[0];
  for (i = 0; i < nx; i++) {
    out->outliers->data[i] = c->data[r2->data[i] - 1];
  }
  emxFree_int32_T(&r2);
  emxFree_real_T(&c);
  out->conflev = varargin_14;
  i = out->rhofunc->size[0] * out->rhofunc->size[1];
  out->rhofunc->size[0] = varargin_6->size[0];
  out->rhofunc->size[1] = varargin_6->size[1];
  emxEnsureCapacity_char_T(out->rhofunc, i);
  nx = varargin_6->size[0] * varargin_6->size[1];
  for (i = 0; i < nx; i++) {
    out->rhofunc->data[i] = varargin_6->data[i];
  }
  /*  In case of Hampel or hyperbolic tangent estimator store the additional */
  /*  parameters which have been used */
  /*  For Hampel store a vector of length 3 containing parameters a, b and c */
  /*  For hyperbolic store the value of k= sup CVC */
  /*  Store X (without the column of ones if there is an intercept) */
  /*  Plot of residual with outliers highlighted */
}

/* End of code generation (MMregcore.c) */
