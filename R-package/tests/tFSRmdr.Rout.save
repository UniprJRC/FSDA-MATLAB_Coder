
R Under development (unstable) (2021-04-28 r80240) -- "Unsuffered Consequences"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ##  Testing FSRmdr()==============================================
> 
>     library(fsdac)
> 
> ##  1. FSRmdr with all default options. Compute minimum deletion residual.
> ##      Monitor minimum deletion residual in each step of the forward search.
> ##      Common part to all examples: load fishery dataset.
> 
> ##  All examples #1-#7 use the same data fishery. LXS is used only
> ##  once for finding the initial values for bsb
> 
>     data(fishery)
>     y <- fishery[, 2, drop=FALSE]
>     X <- fishery[, 1, drop=FALSE]
> 
>     ## Instead of calling LXS, take hard-coded bsb - this is faster,
>     ##  more deterministic and guarantees that there is no crash of R
> 
>     ##  out <- LXS(y, X, nsamp=10000)
>     ##  bsb <- out$bs
>     ##  print(bsb)
> 
>     bsb <- c(14, 163)                               # found by LTS
> 
>     out1 <- FSRmdr(y, X, bsb=bsb)                   # call 'FSRmdr' with all default parameters
>     plot(out1$mdr[,1], out1$mdr[,2], type="l", col="blue",
+       xlab="Step", ylab="minimum deletion residual",
+       main="Monitoring of the minimum deletion residual")
> 
>     out2 <- FSRmdr(y, X)                         # call 'FSRmdr' with missing bsb - will start from random p-sample
>     plot(out2)                                   # same plot as above
> 
>     out1 <- FSRmdr(y, X, bsb=bsb, init=60)           # Example with monitoring from step 60.
>     out1 <- FSRmdr(y, X, bsb=bsb, intercept=FALSE)   # Regression without intercept
>     out1 <- FSRmdr(y, X, bsb=bsb, nocheck=TRUE)      # No checks on y and X (and no intercept)
> 
> ##  2. Analyze units entering the search in the final steps.
> ##
> ##  Compute minimum deletion residual and analyze the units entering
> ##  subset in each step of the fwd search (matrix Un).  As is well known,
> ##  the FS provides an ordering of the data from those most in agreement
> ##  with a suggested model (which enter the first steps) to those least in
> ##  agreement with it (which are included in the final steps).
> 
>     out1 <- FSRmdr(y, X, bsb=bsb)
>     tail(out1$Un)
    Step Unit1 Unit2 Unit3 Unit4 Unit5 Unit6 Unit7 Unit8 Unit9 Unit10
665  672   205   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    NaN
666  673   195   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    NaN
667  674   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    NaN
668  675   207   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    NaN
669  676   200   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    NaN
670  677   212   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    NaN
> 
> ##  3. Units forming subset in each step.
> ##      Obtain detailed information about the units forming subset in each
> ##      step of the forward search (matrix BB).
>     out1 <- FSRmdr(y, X, bsb=bsb)
>     head(out1$BB)
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
[1,]  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN   NaN   NaN   NaN   NaN
[2,]  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN   NaN   NaN   NaN   NaN
[3,]  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN   NaN   NaN   NaN   NaN
[4,]  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN   NaN   NaN   NaN   NaN
[5,]  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN   NaN   NaN   NaN   NaN
[6,]  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN  NaN   NaN   NaN   NaN   NaN   NaN
     [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
[1,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[2,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[3,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[4,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[5,]   NaN   NaN   NaN   NaN   NaN   NaN     5     5     5     5     5     5
[6,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
     [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38]
[1,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[2,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[3,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[4,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[5,]     5     5     5     5     5     5     5     5     5     5     5     5
[6,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
     [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49] [,50]
[1,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[2,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[3,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[4,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[5,]     5     5     5     5     5     5     5     5     5     5     5     5
[6,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
     [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60] [,61] [,62]
[1,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[2,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[3,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[4,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[5,]     5     5     5     5     5     5     5     5     5     5     5     5
[6,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
     [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74]
[1,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[2,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[3,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[4,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[5,]     5     5     5     5     5     5     5     5     5     5     5     5
[6,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
     [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86]
[1,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[2,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[3,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[4,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[5,]     5     5     5     5     5     5     5     5     5     5     5     5
[6,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
     [,87] [,88] [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98]
[1,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[2,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[3,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[4,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
[5,]     5     5     5     5     5     5     5     5     5     5     5     5
[6,]   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
     [,99] [,100] [,101] [,102] [,103] [,104] [,105] [,106] [,107] [,108]
[1,]   NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[2,]   NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[3,]   NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[4,]   NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[5,]     5      5      5      5      5      5      5      5      5      5
[6,]   NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,109] [,110] [,111] [,112] [,113] [,114] [,115] [,116] [,117] [,118]
[1,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[2,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[3,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[4,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,119] [,120] [,121] [,122] [,123] [,124] [,125] [,126] [,127] [,128]
[1,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[2,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[3,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[4,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,129] [,130] [,131] [,132] [,133] [,134] [,135] [,136] [,137] [,138]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]    NaN    NaN    NaN    NaN    NaN      2      2      2      2      2
[3,]    NaN      3      3      3      3      3      3      3      3      3
[4,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,139] [,140] [,141] [,142] [,143] [,144] [,145] [,146] [,147] [,148]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,149] [,150] [,151] [,152] [,153] [,154] [,155] [,156] [,157] [,158]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,159] [,160] [,161] [,162] [,163] [,164] [,165] [,166] [,167] [,168]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,169] [,170] [,171] [,172] [,173] [,174] [,175] [,176] [,177] [,178]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,179] [,180] [,181] [,182] [,183] [,184] [,185] [,186] [,187] [,188]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,189] [,190] [,191] [,192] [,193] [,194] [,195] [,196] [,197] [,198]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,199] [,200] [,201] [,202] [,203] [,204] [,205] [,206] [,207] [,208]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,209] [,210] [,211] [,212] [,213] [,214] [,215] [,216] [,217] [,218]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,219] [,220] [,221] [,222] [,223] [,224] [,225] [,226] [,227] [,228]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,229] [,230] [,231] [,232] [,233] [,234] [,235] [,236] [,237] [,238]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,239] [,240] [,241] [,242] [,243] [,244] [,245] [,246] [,247] [,248]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN    NaN
     [,249] [,250] [,251] [,252] [,253] [,254] [,255] [,256] [,257] [,258]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]    NaN      6      6      6      6      6      6      6      6      6
     [,259] [,260] [,261] [,262] [,263] [,264] [,265] [,266] [,267] [,268]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,269] [,270] [,271] [,272] [,273] [,274] [,275] [,276] [,277] [,278]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,279] [,280] [,281] [,282] [,283] [,284] [,285] [,286] [,287] [,288]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,289] [,290] [,291] [,292] [,293] [,294] [,295] [,296] [,297] [,298]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,299] [,300] [,301] [,302] [,303] [,304] [,305] [,306] [,307] [,308]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,309] [,310] [,311] [,312] [,313] [,314] [,315] [,316] [,317] [,318]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,319] [,320] [,321] [,322] [,323] [,324] [,325] [,326] [,327] [,328]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,329] [,330] [,331] [,332] [,333] [,334] [,335] [,336] [,337] [,338]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,339] [,340] [,341] [,342] [,343] [,344] [,345] [,346] [,347] [,348]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,349] [,350] [,351] [,352] [,353] [,354] [,355] [,356] [,357] [,358]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,359] [,360] [,361] [,362] [,363] [,364] [,365] [,366] [,367] [,368]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,369] [,370] [,371] [,372] [,373] [,374] [,375] [,376] [,377] [,378]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,379] [,380] [,381] [,382] [,383] [,384] [,385] [,386] [,387] [,388]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,389] [,390] [,391] [,392] [,393] [,394] [,395] [,396] [,397] [,398]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,399] [,400] [,401] [,402] [,403] [,404] [,405] [,406] [,407] [,408]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,409] [,410] [,411] [,412] [,413] [,414] [,415] [,416] [,417] [,418]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,419] [,420] [,421] [,422] [,423] [,424] [,425] [,426] [,427] [,428]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,429] [,430] [,431] [,432] [,433] [,434] [,435] [,436] [,437] [,438]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,439] [,440] [,441] [,442] [,443] [,444] [,445] [,446] [,447] [,448]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,449] [,450] [,451] [,452] [,453] [,454] [,455] [,456] [,457] [,458]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,459] [,460] [,461] [,462] [,463] [,464] [,465] [,466] [,467] [,468]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,469] [,470] [,471] [,472] [,473] [,474] [,475] [,476] [,477] [,478]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,479] [,480] [,481] [,482] [,483] [,484] [,485] [,486] [,487] [,488]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,489] [,490] [,491] [,492] [,493] [,494] [,495] [,496] [,497] [,498]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,499] [,500] [,501] [,502] [,503] [,504] [,505] [,506] [,507] [,508]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,509] [,510] [,511] [,512] [,513] [,514] [,515] [,516] [,517] [,518]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,519] [,520] [,521] [,522] [,523] [,524] [,525] [,526] [,527] [,528]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,529] [,530] [,531] [,532] [,533] [,534] [,535] [,536] [,537] [,538]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,539] [,540] [,541] [,542] [,543] [,544] [,545] [,546] [,547] [,548]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,549] [,550] [,551] [,552] [,553] [,554] [,555] [,556] [,557] [,558]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,559] [,560] [,561] [,562] [,563] [,564] [,565] [,566] [,567] [,568]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,569] [,570] [,571] [,572] [,573] [,574] [,575] [,576] [,577] [,578]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,579] [,580] [,581] [,582] [,583] [,584] [,585] [,586] [,587] [,588]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,589] [,590] [,591] [,592] [,593] [,594] [,595] [,596] [,597] [,598]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,599] [,600] [,601] [,602] [,603] [,604] [,605] [,606] [,607] [,608]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,609] [,610] [,611] [,612] [,613] [,614] [,615] [,616] [,617] [,618]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,619] [,620] [,621] [,622] [,623] [,624] [,625] [,626] [,627] [,628]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,629] [,630] [,631] [,632] [,633] [,634] [,635] [,636] [,637] [,638]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,639] [,640] [,641] [,642] [,643] [,644] [,645] [,646] [,647] [,648]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,649] [,650] [,651] [,652] [,653] [,654] [,655] [,656] [,657] [,658]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,659] [,660] [,661] [,662] [,663] [,664] [,665] [,666] [,667] [,668]
[1,]      1      1      1      1      1      1      1      1      1      1
[2,]      2      2      2      2      2      2      2      2      2      2
[3,]      3      3      3      3      3      3      3      3      3      3
[4,]      4      4      4      4      4      4      4      4      4      4
[5,]      5      5      5      5      5      5      5      5      5      5
[6,]      6      6      6      6      6      6      6      6      6      6
     [,669] [,670] [,671]
[1,]      1      1      1
[2,]      2      2      2
[3,]      3      3      3
[4,]      4      4      4
[5,]      5      5      5
[6,]      6      6      6
> 
> ##  4. Monitor \( \hat  \beta \). Monitor how the estimates of beta coefficients changes as the subset
> ##      size increases (matrix Bols).
>     out1 <- FSRmdr(y, X, bsb=bsb)
>     head(out1$Bols)
  Step       V1       V2
1    7 1.056241 14.28992
2    8 1.064522 14.28961
3    9 1.071232 14.28934
4   10 1.076580 14.28914
5   11 1.081648 14.28894
6   12 1.086707 14.28874
> 
> ##  5. Monitor $s^2$.
> ##      Monitor the estimate of $\sigma^2$ in each step of the fwd search (matrix S2).
> 
>     out1 <- FSRmdr(y, X, bsb=bsb)
>     plot(out1$S2[, 1], out1$S2[, 2], type="l", col="blue", xlab="Step",
+         ylab=expression("s"^2), main='Monitoring of s2')
> 
> 
> 
> ##  6. Specify a regression model without intercept.
> ##      FSRmdr using a regression model without intercept.
>     out1 <- FSRmdr(y, X, bsb=bsb, intercept=FALSE)
> 
> ##  7. Example of the use of option nocheck.
> ##      FSRmdr applied without doing any checks on y and X variables.
>     out1 <- FSRmdr(y, X, bsb=bsb, nocheck=TRUE)
> 
> ##  8. Monitoring of s2, and the evolution of beta coefficients for the Hawkins dataset
>     data(hawkins)
>     y <- hawkins[, 9, drop=FALSE]
>     X <- hawkins[, 1:8]
> 
>     ## Instead of calling LXS, take hard-coded bsb - this is faster
>     ##  and guarantees that there is no crash of R
> 
>     ##  out <- LXS(y, X, nsamp=10000)
>     ##  print(out$bs)
>     bsb <- c(89, 125,  78,  27,  29,  15,  67,  91,  47)
> 
>     ##  This will cause a crash: with an error message from the C code 'FSDA:FSRmdr,Rank problem in step 10'
>     ##bsb <- c(42,   1,   7,  96,  37, 104,  49, 109,  51)
> 
>     out1 <- FSRmdr(y, X, bsb=bsb)
> 
>     if(sum(is.nan(out1$S2)) > 0) {
+         cat('\nNoFullRank in initial subset, please rerun FSRmdr.\n')
+     } else {
+         ##  The forward plot of s2 shows that initially the estimate is virtually
+         ##  zero. The four line segments comprising the plot correspond to the four
+         ##  groups of observations
+ 
+         ##  Plot of the monitoring of S2 and R2
+         oldpar <- par(mfrow=c(2,1))
+ 
+         plot(out1$S2[,1], out1$S2[,2], xlab='Subset size m', ylab='S2', type="l")
+         plot(out1$S2[,1], out1$S2[,3], xlab='Subset size m', ylab='R2', type="l")
+ 
+         par(oldpar)
+ 
+         ##  The forward plots of the estimates of the beta coefficients show that
+         ##  they are virtually constant until m = 86, after which they start
+         ##  fluctuating in different directions.
+ 
+         ##  Plots of the monitoring of "Estimates of beta coefficients"
+         oldpar <- par(mfrow=c(3,3))
+         for(j in 3:ncol(out1$Bols))
+             plot(out1$Bols[,1], out1$Bols[, j], xlab='Subset size m', ylab=colnames(out1$Bols)[j], type="l")
+         par(oldpar)
+     }
> 
> ##  9. Store units forming subsets in selected steps.
> ##      In this example the units forming subset are stored just for
> ##      selected steps.
> 
>     data(hawkins)
>     y <- hawkins[, 9, drop=FALSE]
>     X <- hawkins[, 1:8]
> 
>     ## Instead of calling LXS, take hard-coded bsb - this is faster
>     ##  and guarantees that there is no crash of R
> 
>     ##  out <- LXS(y, X, nsamp=10000)
>     ##  print(out$bs)
>     bsb <- c(89, 125,  78,  27,  29,  15,  67,  91,  47)
> 
>     ##  This will cause a crash: with an error message from the C code 'FSDA:FSRmdr,Rank problem in step 10'
>     ##  bsb <- c(42,   1,   7,  96,  37, 104,  49, 109,  51)
> 
>     out1 <- FSRmdr(y, X, bsb=bsb, bsbsteps=c(30, 60))
>     head(out1$mdr)
  Step      MDR
1   28 2.165113
2   29 1.875426
3   30 1.614791
4   31 1.541885
5   32 1.792951
6   33 1.810484
> 
>     if(sum(is.nan(out1$S2)) > 0) {
+         cat('\nNoFullRank in initial subset, please rerun FSRmdr.\n')
+     } else {
+         ##  BB has just two columns
+         ##  First column contains information about units forming subset at step m=30
+         ##  sum(~isnan(BB(:,1))) is 30
+         ##  Second column contains information about units forming subset at step m=60
+         ##  sum(~isnan(BB(:,2))) is 60
+ 
+         print(sum(!is.nan(out1$BB[, 1])))
+         print(sum(!is.nan(out1$BB[, 2])))
+     }
[1] 30
[1] 60
> 
> 
> ##  10. Example of the use of option threshlevoutX.
> ##      In this example a set of remote units is added to a cloud of points.
> ##      The purpose of this example is to show that in presence of units very far
> ##      from the bulk of th data (bad or good elverage points) it is necessary to
> ##      bound their effect putting a constraint on their leverage hi=xi'(X'X)xi
> 
>     set.seed(10000)
> 
>     n <- 100
>     p <- 1
>     X <- matrix(rnorm(n*p), nrow=n)
>     epsil <- 10
>     beta <- rep(1, p)
>     y <- X %*% beta + rnorm(n) * epsil
> 
>     ##  Add 10 very remote points
>     add <- 3
>     Xadd <- X[1:add, , drop=FALSE] + 5000
>     yadd <- y[1:add] + 200
>     Xall <- rbind(X, Xadd)
>     yall <- c(y, yadd)
> 
>     ## Instead of calling LXS, take hard-coded bsb - this is faster,
>     ##  more deterministic and guarantees that there is no crash of R
> 
>     ##  outLXS <- LXS(y, X)
>     ##  bsb <- outLXS$bs
>     ##  print(bsb)
> 
>     bsb <- c(5, 46)
> 
>     out1 <- FSRmdr(yall, Xall, bsb=bsb)
>     out2 <- FSRmdr(yall, Xall, bsb=bsb, threshlevoutX=10)
>     print(head(out1$mdr))
  Step       MDR
1    7 0.8697592
2    8 0.8290465
3    9 1.9128247
4   10 2.0924264
5   11 1.9131512
6   12 1.5657342
> 
> ##  We cannot draw yet the envelopes as it is done in MATLAB, see
> ##  below the commented code; will draw just mdr
> 
>     ##  out1=FSRmdr(yall,Xall,bs,'plots',1)
>     ##  xylim=axis
>     ##  ylabel('mdr')
>     ##  title('Monitoring of mdr without bound on the leverage')
> 
>     ##  out2=FSRmdr(yall,Xall,bs,'plots',1,'threshlevoutX',10);
>     ##  ylim(xylim(3:4));
>     ##  ylabel('mdr')
>     ##  title('Monitoring of mdr with bound on the leverage')
> 
>     oldpar <- par(mfrow=c(2,1))
> 
>     plot(out1$mdr[,1], out1$mdr[,2], xlab='Subset size m', ylab='mdr', ylim=c(0,5), xlim=c(0,120), main="Monitoring of mdr without bound on the leverage", type="l")
>     plot(out2$mdr[,1], out2$mdr[,2], xlab='Subset size m', ylab='mdr', ylim=c(0,5), xlim=c(0,120), main="Monitoring of mdr with bound on the leverage", type="l")
> 
>     par(oldpar)
> 
> proc.time()
   user  system elapsed 
   0.82    0.14    0.90 
