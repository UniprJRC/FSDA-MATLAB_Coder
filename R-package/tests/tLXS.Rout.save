
R Under development (unstable) (2021-04-28 r80240) -- "Unsuffered Consequences"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(fsdac)
> 
> data(hbk, package="robustbase")
> XX <- hbk
> y <- XX[, ncol(XX)]
> X <- XX[, 1:(ncol(XX)-1), drop=FALSE]
> 
> (out <- LXS(y, X, alpha=0.5, lms=2, rew=TRUE, intercept=TRUE, msg=FALSE))

Call:
LXS(y = y, x = X, intercept = TRUE, lms = 2, rew = TRUE, alpha = 0.5,     msg = FALSE)

Coefficients:
[1]  -0.18046   0.08138   0.03990  -0.05167

Scale estimate 0.7362 

> out$outliers
 [1]  1  2  3  4  5  6  7  8  9 10
> out$residuals
 [1] 13.22863821 13.83163987 14.13430392 13.11470511 13.72924608 13.57857180
 [7] 14.66431337 14.10086051 13.26688528 13.72368869 -0.08700712 -0.27466044
[13]  0.84640109 -0.29169165 -0.68386364  0.61928633 -0.09922658  0.04452587
[19]  0.24764254  0.41591415  1.19435896  0.56832786 -1.13116737  0.96271623
[25] -0.24484772 -0.94446422 -1.00249554  0.55066999  0.52735808 -0.09435406
[31] -0.10324896 -0.46251537 -0.79845612 -0.70081669  0.39042331 -1.16458928
[37] -0.56107719  1.25084946 -0.85364852 -0.51350901 -0.14974519 -0.60360179
[43]  0.93340102 -0.70722435 -0.60739439 -0.31374894 -1.25830383  0.16211010
[49]  1.12282722 -0.47859329  0.88851676 -0.74714609  1.37274868  0.93284747
[55]  0.12294210  0.07171277  1.00820357 -0.23501885 -0.24252563 -0.86026831
[61] -0.18033651  0.97630315 -0.41628227 -0.70265059  0.99062000 -1.04092720
[67] -0.90678025  1.12630221  0.28425674  1.16973373  0.29952751 -0.09599732
[73]  0.81757591 -0.98435443  0.64443588
> 
> ##  #1. LXS with default input and output.
> ##  Compute LMS estimator without reweighting, add intercept to matrix X
> n <- 200
> p <- 3
> set.seed(123456)
> X <- matrix(rnorm(n*p), nrow=n)
> y <- rnorm(n)
> y[1:5] <- y[1:5] + 6
> (out <- LXS(y,X, msg=FALSE))

Call:
LXS(y = y, x = X, msg = FALSE)

Coefficients:
[1]   0.16189  -0.07228  -0.10384   0.08498

Scale estimate 0.9597 

> out$outliers
 [1]   1   2   3   4   5  93 102 131 151 159 164 189 197
> out$residuals
  [1]  6.162659e+00  6.359646e+00  7.022705e+00  5.047028e+00  8.768711e+00
  [6] -1.158177e+00 -1.485790e-02 -7.087178e-02 -3.281395e-01  5.165626e-01
 [11] -7.388654e-02  5.937675e-01 -2.297758e-01  8.295246e-01 -1.593928e+00
 [16] -2.035835e-01 -2.782775e-01  7.655948e-01  3.286198e-01 -4.034056e-01
 [21] -3.624542e-01  1.267284e+00  1.065262e+00 -4.836303e-01  2.885793e-01
 [26]  2.002648e-01  2.888097e-02 -5.772448e-01 -2.117920e+00  5.620874e-01
 [31] -4.406417e-01 -8.899898e-01  1.298500e+00 -2.223858e+00  8.384994e-01
 [36]  1.811340e-01 -1.600741e-01  8.023647e-01 -9.183731e-01  1.482755e-01
 [41] -8.099963e-01  4.945025e-01  1.585997e-01 -1.101841e+00 -8.693548e-03
 [46] -2.823714e-01  1.196661e+00  7.664694e-01  1.467792e+00 -1.038581e-01
 [51] -3.834352e-01 -3.869526e-01  1.156688e+00 -1.182522e+00  9.744450e-01
 [56] -8.109885e-01  1.136944e+00 -2.092465e+00 -8.614992e-01  7.945938e-01
 [61]  1.091504e+00  1.000720e+00  1.175817e+00  7.699615e-01 -8.291857e-01
 [66] -4.144496e-01 -4.026612e-01 -3.736231e-01 -5.014928e-01  7.115640e-02
 [71] -1.855728e+00 -4.275031e-01 -9.142131e-01 -8.937723e-02  6.575570e-01
 [76] -1.533812e+00 -1.913205e+00 -6.922808e-01 -2.261397e+00 -9.229349e-01
 [81] -7.909121e-02  1.747495e-01  5.306404e-01 -1.435207e+00 -4.340567e-01
 [86]  7.606933e-01  3.248288e-01  1.193095e+00  1.161236e+00 -2.565930e-01
 [91] -1.112648e+00 -1.300639e+00 -2.754221e+00 -7.753070e-01 -6.524351e-01
 [96] -1.440036e-01 -1.009631e-02  7.266530e-01  5.249911e-01 -9.727448e-01
[101]  7.616935e-03  2.536370e+00 -1.025267e+00 -1.629346e+00 -6.939994e-01
[106] -5.853108e-01 -1.153525e+00  1.895663e-01 -3.324749e-01 -2.339141e-01
[111] -2.785246e-01  2.121189e-02 -6.953587e-01  0.000000e+00  1.871616e+00
[116] -1.275625e+00 -1.389024e+00  3.737677e-02 -1.555479e+00 -1.548356e+00
[121]  1.446009e-17 -1.749587e+00 -3.343776e-01 -1.319451e+00 -4.913193e-01
[126]  2.941021e-01  4.181598e-01 -8.682252e-01 -1.385598e+00 -1.750845e+00
[131] -2.641879e+00 -1.312120e+00 -8.800763e-01  1.406172e+00 -2.219617e-01
[136]  2.397709e-01  1.638318e-02  1.650042e+00  1.566128e-01 -1.202681e-02
[141]  2.719743e-01  5.159374e-03  4.932968e-01  1.289675e+00 -1.371870e+00
[146]  4.880088e-01 -1.482296e+00  5.726105e-01  4.773481e-01  2.958847e-01
[151] -2.941079e+00 -1.263587e+00 -1.053676e+00 -1.629127e-01 -2.276808e+00
[156]  1.004643e+00  6.550653e-01  1.257507e+00  2.687792e+00  1.021265e+00
[161]  1.687496e-01 -8.143467e-01 -1.815129e+00 -3.062652e+00  5.784036e-17
[166]  2.080006e+00 -1.071311e+00  6.464724e-01 -1.991167e+00  1.042988e+00
[171]  1.003024e+00  7.230045e-18 -3.337850e-01  1.110715e-02 -4.337691e-01
[176]  5.339742e-02 -8.151721e-03 -7.151213e-01  7.951435e-01 -1.908871e+00
[181] -1.023941e+00 -4.874661e-01 -8.722660e-02  2.686917e-01  6.937670e-01
[186]  7.473407e-01  4.905955e-02 -9.449783e-02 -2.649161e+00 -1.134702e+00
[191] -3.705450e-01  4.598826e-01 -1.986090e+00  2.459188e-01  8.647038e-01
[196] -8.297947e-01 -2.312060e+00  7.008544e-01 -1.671075e-01  2.038301e-01
> 
> ##  #3. LXS with optional output.
> ##  Generating the C matrix containing the indices of the subsamples
> ##  extracted for computing the estimate (the so called elemental sets).
> n <- 200
> p <- 3
> set.seed(123456)
> X <- matrix(rnorm(n*p), nrow=n)
> y <- rnorm(n)
> y[1:5] <- y[1:5] + 6
> (out <- LXS(y,X, csave=TRUE, msg=FALSE))

Call:
LXS(y = y, x = X, msg = FALSE, csave = TRUE)

Coefficients:
[1]   0.099253  -0.015731  -0.013775   0.008232

Scale estimate 0.9427 

> out$outliers
 [1]   1   2   3   4   5  93 102 131 151 159 164 189
> out$residuals
  [1]  6.417849e+00  6.593893e+00  7.234007e+00  5.126634e+00  8.639337e+00
  [6] -1.369462e+00  1.068896e-01 -1.589093e-01 -3.189908e-01  3.903362e-01
 [11]  3.310481e-01  5.839182e-01 -2.678923e-01  9.331323e-01 -1.755128e+00
 [16] -2.544305e-01 -2.471730e-01  8.676091e-01  2.934253e-01 -5.082336e-01
 [21] -4.507710e-01  1.232683e+00  1.326759e+00 -3.956826e-01  4.362316e-01
 [26]  3.342003e-01  1.657353e-01 -4.161060e-01 -2.055030e+00  5.007012e-01
 [31] -6.120060e-01 -8.482364e-01  1.351997e+00 -1.998505e+00  1.026910e+00
 [36]  3.011324e-01 -1.326119e-01  7.072553e-01 -7.328004e-01  2.915228e-01
 [41] -7.994476e-01  5.953356e-01  7.562874e-02 -9.835308e-01 -4.976269e-02
 [46] -2.270996e-01  1.535817e+00  8.884654e-01  1.464616e+00 -6.116263e-02
 [51] -1.404779e-01 -2.361173e-01  1.227892e+00 -1.331951e+00  1.114575e+00
 [56] -7.537503e-01  1.281318e+00 -2.001318e+00 -5.975663e-01  8.055476e-01
 [61]  1.187616e+00  1.010560e+00  1.063666e+00  7.220962e-01 -5.293514e-01
 [66] -5.165674e-01 -3.312667e-01 -4.154736e-01 -4.610316e-01  2.069638e-01
 [71] -1.892740e+00 -5.585273e-01 -6.254537e-01 -5.952622e-02  7.247956e-01
 [76] -1.538720e+00 -2.056330e+00 -7.634200e-01 -1.880545e+00 -8.578666e-01
 [81] -8.118781e-02  7.007567e-02  6.647509e-01 -1.563210e+00 -4.287009e-01
 [86]  7.765393e-01  3.921989e-01  1.182129e+00  1.057298e+00  5.498243e-02
 [91] -9.626985e-01 -1.312790e+00 -2.747192e+00 -6.968690e-01 -4.820150e-01
 [96]  1.077755e-01 -1.331761e-02  8.373255e-01  3.570521e-01 -1.181415e+00
[101] -3.024004e-02  2.598976e+00 -1.024524e+00 -1.422592e+00 -6.183984e-01
[106] -3.636695e-01 -9.237402e-01  3.083708e-01 -3.474119e-01 -1.749342e-01
[111]  3.444722e-01  1.310026e-01 -6.325549e-01  5.369433e-02  2.168769e+00
[116] -1.185861e+00 -1.402734e+00 -6.972706e-02 -1.232085e+00 -1.692100e+00
[121] -1.472183e-17 -1.699413e+00  0.000000e+00 -9.325988e-01 -3.432622e-01
[126]  3.588558e-01  3.062271e-01 -8.086714e-01 -1.511522e+00 -1.814317e+00
[131] -2.388742e+00 -1.245773e+00 -7.736288e-01  1.298554e+00 -4.680115e-02
[136]  3.994227e-01 -1.664072e-02  1.609424e+00  2.766243e-01 -3.809441e-02
[141]  2.953775e-01  0.000000e+00  5.620531e-01  1.377064e+00 -1.455134e+00
[146]  6.054126e-01 -1.261357e+00  8.195888e-01  4.910127e-01  4.614589e-01
[151] -2.940467e+00 -1.347142e+00 -8.933643e-01  5.664268e-03 -1.902930e+00
[156]  9.691736e-01  6.301110e-01  1.145394e+00  3.043075e+00  1.056433e+00
[161]  4.373904e-01 -9.852149e-01 -1.688979e+00 -3.105227e+00  3.019190e-01
[166]  2.263403e+00 -1.058748e+00  6.540446e-01 -1.753037e+00  1.165371e+00
[171]  1.228378e+00 -1.141841e-01 -4.284387e-01 -2.272764e-02 -5.591318e-01
[176]  2.635832e-03  2.666074e-02 -8.172274e-01  8.356102e-01 -1.578056e+00
[181] -8.930989e-01 -4.931000e-01  0.000000e+00  1.569705e-01  7.383163e-01
[186]  6.212027e-01  1.795156e-01 -6.332826e-02 -2.597835e+00 -1.154676e+00
[191] -1.520394e-01  5.418309e-01 -1.886239e+00  1.936538e-01  8.408990e-01
[196] -8.829454e-01 -2.243769e+00  6.102138e-01  7.783734e-02  3.242887e-01
> 
> proc.time()
   user  system elapsed 
   0.26    0.07    0.31 
